# Install and load the necessary packages
# install.packages("tidyverse")
# install.packages("splitstackshape")
# install.packages("dplyr")
# install.packages("stringr")

library(tidyverse)
library(splitstackshape)
library(dplyr)
library(stringr)

options(max.print=1000000)

# Set the working directory
setwd("C:/Users/ual-laptop/Downloads/GenBank Research/Spring 2023 Research/Data")

# Read the csv file into a tibble
d <- read.csv("C:/Users/ual-laptop/Downloads/GenBank Research/Spring 2023 Research/Data/GB_NIH_TOTAL_COST_subset.csv") 

# d <- d %>% select(authors.x, authors.y)

# d <- d[1:200,]

# Replace the " and" in the authors.x column with a single comma ","
d$authors.x<- gsub(" and",",", d$authors.x) 
d$authors.x <- gsub(" and ",",", d$authors.x)
d$authors.x <- gsub("and ",",", d$authors.x)

d <- cSplit(d, "authors.x", ".,",'wide')
# d <- cSplit(d, "authors.y", ".,",'wide')

# Adding new columns to the tibble where the overlapping and non-overlapping names will be stored
d <- d %>% 
  add_column(overlapping_names = "")
d <- d %>% 
  add_column(non_overlapping_names = "")
d <- d %>% 
  add_column(authors.y_dup = "")

d$authors.y_dup <- d$authors.y

# Replace the " and" in the authors.y column with a single comma ","
d$authors.y<- gsub(" and",",", d$authors.y) 
d$authors.y <- gsub(" and ",",", d$authors.y)
d$authors.y <- gsub("and ",",", d$authors.y)

# Replace the " and" in the authors.y_dup column with a single comma ","
d$authors.y_dup<- gsub(" and",",", d$authors.y_dup) 
d$authors.y_dup <- gsub(" and ",",", d$authors.y_dup)
d$authors.y_dup <- gsub("and ",",", d$authors.y_dup)

d <- d %>% replace_na(list(authors.x_001 = ""))
d <- d %>% replace_na(list(authors.x_002 = ""))
d <- d %>% replace_na(list(authors.x_003 = ""))
d <- d %>% replace_na(list(authors.x_004 = ""))
d <- d %>% replace_na(list(authors.x_005 = ""))
d <- d %>% replace_na(list(authors.x_006 = ""))
d <- d %>% replace_na(list(authors.x_007 = ""))
d <- d %>% replace_na(list(authors.x_008 = ""))
d <- d %>% replace_na(list(authors.x_009 = ""))
d <- d %>% replace_na(list(authors.x_010 = ""))
d <- d %>% replace_na(list(authors.x_011 = ""))
d <- d %>% replace_na(list(authors.x_012 = ""))
d <- d %>% replace_na(list(authors.x_013 = ""))
d <- d %>% replace_na(list(authors.x_014 = ""))
d <- d %>% replace_na(list(authors.x_015 = ""))
d <- d %>% replace_na(list(authors.x_016 = ""))
d <- d %>% replace_na(list(authors.x_017 = ""))
d <- d %>% replace_na(list(authors.x_018 = ""))
d <- d %>% replace_na(list(authors.x_019 = ""))
d <- d %>% replace_na(list(authors.x_020 = ""))
d <- d %>% replace_na(list(authors.x_021 = ""))
d <- d %>% replace_na(list(authors.x_022 = ""))
d <- d %>% replace_na(list(authors.x_023 = ""))
d <- d %>% replace_na(list(authors.x_024 = ""))
d <- d %>% replace_na(list(authors.x_025 = ""))
d <- d %>% replace_na(list(authors.x_026 = ""))
d <- d %>% replace_na(list(authors.x_027 = ""))
d <- d %>% replace_na(list(authors.x_028 = ""))
d <- d %>% replace_na(list(authors.x_029 = ""))
d <- d %>% replace_na(list(authors.x_030 = ""))
d <- d %>% replace_na(list(authors.x_031 = ""))
d <- d %>% replace_na(list(authors.x_032 = ""))
d <- d %>% replace_na(list(authors.x_033 = ""))
d <- d %>% replace_na(list(authors.x_034 = ""))
d <- d %>% replace_na(list(authors.x_035 = ""))
d <- d %>% replace_na(list(authors.x_036 = ""))
d <- d %>% replace_na(list(authors.x_037 = ""))
d <- d %>% replace_na(list(authors.x_038 = ""))
d <- d %>% replace_na(list(authors.x_039 = ""))
d <- d %>% replace_na(list(authors.x_040 = ""))
d <- d %>% replace_na(list(authors.x_041 = ""))
d <- d %>% replace_na(list(authors.x_042 = ""))
d <- d %>% replace_na(list(authors.x_043 = ""))
d <- d %>% replace_na(list(authors.x_044 = ""))
d <- d %>% replace_na(list(authors.x_045 = ""))
d <- d %>% replace_na(list(authors.x_046 = ""))
d <- d %>% replace_na(list(authors.x_047 = ""))
d <- d %>% replace_na(list(authors.x_048 = ""))
d <- d %>% replace_na(list(authors.x_049 = ""))
d <- d %>% replace_na(list(authors.x_050 = ""))
d <- d %>% replace_na(list(authors.x_051 = ""))
d <- d %>% replace_na(list(authors.x_052 = ""))
d <- d %>% replace_na(list(authors.x_053 = ""))
d <- d %>% replace_na(list(authors.x_054 = ""))
d <- d %>% replace_na(list(authors.x_055 = ""))
d <- d %>% replace_na(list(authors.x_056 = ""))
d <- d %>% replace_na(list(authors.x_057 = ""))
d <- d %>% replace_na(list(authors.x_058 = ""))
d <- d %>% replace_na(list(authors.x_059 = ""))
d <- d %>% replace_na(list(authors.x_060 = ""))
d <- d %>% replace_na(list(authors.x_061 = ""))
d <- d %>% replace_na(list(authors.x_062 = ""))
d <- d %>% replace_na(list(authors.x_063 = ""))
d <- d %>% replace_na(list(authors.x_064 = ""))
d <- d %>% replace_na(list(authors.x_065 = ""))
d <- d %>% replace_na(list(authors.x_066 = ""))
d <- d %>% replace_na(list(authors.x_067 = ""))
d <- d %>% replace_na(list(authors.x_068 = ""))
d <- d %>% replace_na(list(authors.x_069 = ""))
d <- d %>% replace_na(list(authors.x_070 = ""))
d <- d %>% replace_na(list(authors.x_071 = ""))
d <- d %>% replace_na(list(authors.x_072 = ""))
d <- d %>% replace_na(list(authors.x_073 = ""))
d <- d %>% replace_na(list(authors.x_074 = ""))
d <- d %>% replace_na(list(authors.x_075 = ""))
d <- d %>% replace_na(list(authors.x_076 = ""))
d <- d %>% replace_na(list(authors.x_077 = ""))
d <- d %>% replace_na(list(authors.x_078 = ""))
d <- d %>% replace_na(list(authors.x_079 = ""))
d <- d %>% replace_na(list(authors.x_080 = ""))
d <- d %>% replace_na(list(authors.x_081 = ""))
d <- d %>% replace_na(list(authors.x_082 = ""))
d <- d %>% replace_na(list(authors.x_083 = ""))
d <- d %>% replace_na(list(authors.x_084 = ""))
d <- d %>% replace_na(list(authors.x_085 = ""))
d <- d %>% replace_na(list(authors.x_086 = ""))
d <- d %>% replace_na(list(authors.x_087 = ""))
d <- d %>% replace_na(list(authors.x_088 = ""))
d <- d %>% replace_na(list(authors.x_089 = ""))
d <- d %>% replace_na(list(authors.x_090 = ""))
d <- d %>% replace_na(list(authors.x_091 = ""))
d <- d %>% replace_na(list(authors.x_092 = ""))
d <- d %>% replace_na(list(authors.x_093 = ""))
d <- d %>% replace_na(list(authors.x_094 = ""))
d <- d %>% replace_na(list(authors.x_095 = ""))
d <- d %>% replace_na(list(authors.x_096 = ""))
d <- d %>% replace_na(list(authors.x_097 = ""))
d <- d %>% replace_na(list(authors.x_098 = ""))
d <- d %>% replace_na(list(authors.x_099 = ""))
d <- d %>% replace_na(list(authors.x_100 = ""))
d <- d %>% replace_na(list(authors.x_101 = ""))
d <- d %>% replace_na(list(authors.x_102 = ""))
d <- d %>% replace_na(list(authors.x_103 = ""))
d <- d %>% replace_na(list(authors.x_104 = ""))
d <- d %>% replace_na(list(authors.x_105 = ""))
d <- d %>% replace_na(list(authors.x_106 = ""))
d <- d %>% replace_na(list(authors.x_107 = ""))
d <- d %>% replace_na(list(authors.x_108 = ""))
d <- d %>% replace_na(list(authors.x_109 = ""))
d <- d %>% replace_na(list(authors.x_110 = ""))
d <- d %>% replace_na(list(authors.x_111 = ""))
d <- d %>% replace_na(list(authors.x_112 = ""))
d <- d %>% replace_na(list(authors.x_113 = ""))
d <- d %>% replace_na(list(authors.x_114 = ""))
d <- d %>% replace_na(list(authors.x_115 = ""))
d <- d %>% replace_na(list(authors.x_116 = ""))
d <- d %>% replace_na(list(authors.x_117 = ""))
d <- d %>% replace_na(list(authors.x_118 = ""))
d <- d %>% replace_na(list(authors.x_119 = ""))
d <- d %>% replace_na(list(authors.x_120 = ""))
d <- d %>% replace_na(list(authors.x_121 = ""))
d <- d %>% replace_na(list(authors.x_122 = ""))
d <- d %>% replace_na(list(authors.x_123 = ""))
d <- d %>% replace_na(list(authors.x_124 = ""))
d <- d %>% replace_na(list(authors.x_125 = ""))
d <- d %>% replace_na(list(authors.x_126 = ""))
d <- d %>% replace_na(list(authors.x_127 = ""))
d <- d %>% replace_na(list(authors.x_128 = ""))
d <- d %>% replace_na(list(authors.x_129 = ""))
d <- d %>% replace_na(list(authors.x_130 = ""))
d <- d %>% replace_na(list(authors.x_131 = ""))
d <- d %>% replace_na(list(authors.x_132 = ""))
d <- d %>% replace_na(list(authors.x_133 = ""))
d <- d %>% replace_na(list(authors.x_134 = ""))
d <- d %>% replace_na(list(authors.x_135 = ""))
d <- d %>% replace_na(list(authors.x_136 = ""))
d <- d %>% replace_na(list(authors.x_137 = ""))
d <- d %>% replace_na(list(authors.x_138 = ""))
d <- d %>% replace_na(list(authors.x_139 = ""))
d <- d %>% replace_na(list(authors.x_140 = ""))
d <- d %>% replace_na(list(authors.x_141 = ""))
d <- d %>% replace_na(list(authors.x_142 = ""))
d <- d %>% replace_na(list(authors.x_143 = ""))
d <- d %>% replace_na(list(authors.x_144 = ""))
d <- d %>% replace_na(list(authors.x_145 = ""))
d <- d %>% replace_na(list(authors.x_146 = ""))
d <- d %>% replace_na(list(authors.x_147 = ""))
d <- d %>% replace_na(list(authors.x_148 = ""))
d <- d %>% replace_na(list(authors.x_149 = ""))
d <- d %>% replace_na(list(authors.x_150 = ""))
d <- d %>% replace_na(list(authors.x_151 = ""))
d <- d %>% replace_na(list(authors.x_152 = ""))
d <- d %>% replace_na(list(authors.x_153 = ""))
d <- d %>% replace_na(list(authors.x_154 = ""))
d <- d %>% replace_na(list(authors.x_155 = ""))
d <- d %>% replace_na(list(authors.x_156 = ""))
d <- d %>% replace_na(list(authors.x_157 = ""))
d <- d %>% replace_na(list(authors.x_158 = ""))
d <- d %>% replace_na(list(authors.x_159 = ""))
d <- d %>% replace_na(list(authors.x_160 = ""))
d <- d %>% replace_na(list(authors.x_161 = ""))
d <- d %>% replace_na(list(authors.x_162 = ""))
d <- d %>% replace_na(list(authors.x_163 = ""))
d <- d %>% replace_na(list(authors.x_164 = ""))
d <- d %>% replace_na(list(authors.x_165 = ""))
d <- d %>% replace_na(list(authors.x_166 = ""))
d <- d %>% replace_na(list(authors.x_167 = ""))
d <- d %>% replace_na(list(authors.x_168 = ""))
d <- d %>% replace_na(list(authors.x_169 = ""))
d <- d %>% replace_na(list(authors.x_170 = ""))
d <- d %>% replace_na(list(authors.x_171 = ""))
d <- d %>% replace_na(list(authors.x_172 = ""))
d <- d %>% replace_na(list(authors.x_173 = ""))
d <- d %>% replace_na(list(authors.x_174 = ""))
d <- d %>% replace_na(list(authors.x_175 = ""))
d <- d %>% replace_na(list(authors.x_176 = ""))
d <- d %>% replace_na(list(authors.x_177 = ""))
d <- d %>% replace_na(list(authors.x_178 = ""))
d <- d %>% replace_na(list(authors.x_179 = ""))
d <- d %>% replace_na(list(authors.x_180 = ""))
d <- d %>% replace_na(list(authors.x_181 = ""))
d <- d %>% replace_na(list(authors.x_182 = ""))
d <- d %>% replace_na(list(authors.x_183 = ""))
d <- d %>% replace_na(list(authors.x_184 = ""))
d <- d %>% replace_na(list(authors.x_185 = ""))
d <- d %>% replace_na(list(authors.x_186 = ""))
d <- d %>% replace_na(list(authors.x_187 = ""))
d <- d %>% replace_na(list(authors.x_188 = ""))
d <- d %>% replace_na(list(authors.x_189 = ""))
d <- d %>% replace_na(list(authors.x_190 = ""))
d <- d %>% replace_na(list(authors.x_191 = ""))
d <- d %>% replace_na(list(authors.x_192 = ""))
d <- d %>% replace_na(list(authors.x_193 = ""))
d <- d %>% replace_na(list(authors.x_194 = ""))
d <- d %>% replace_na(list(authors.x_195 = ""))
d <- d %>% replace_na(list(authors.x_196 = ""))
d <- d %>% replace_na(list(authors.x_197 = ""))
d <- d %>% replace_na(list(authors.x_198 = ""))
d <- d %>% replace_na(list(authors.x_199 = ""))
d <- d %>% replace_na(list(authors.x_200 = ""))
d <- d %>% replace_na(list(authors.x_201 = ""))
d <- d %>% replace_na(list(authors.x_202 = ""))
d <- d %>% replace_na(list(authors.x_203 = ""))
d <- d %>% replace_na(list(authors.x_204 = ""))
d <- d %>% replace_na(list(authors.x_205 = ""))
d <- d %>% replace_na(list(authors.x_206 = ""))
d <- d %>% replace_na(list(authors.x_207 = ""))
d <- d %>% replace_na(list(authors.x_208 = ""))
d <- d %>% replace_na(list(authors.x_209 = ""))
d <- d %>% replace_na(list(authors.x_210 = ""))
d <- d %>% replace_na(list(authors.x_211 = ""))
d <- d %>% replace_na(list(authors.x_212 = ""))
d <- d %>% replace_na(list(authors.x_213 = ""))

d <- d %>% 
  add_column(authors.y_dup2 = "")
d$authors.y_dup2 <- d$authors.y

d <- d %>% 
  add_column(count_overlapping_names = 0)

d <- d %>% 
  add_column(count_non_overlapping_names = 0)

for (i in 1:nrow(d)) {
  
  d[[i,"authors.x_001"]] <- str_replace_all(d[[i,"authors.x_001"]],",","")
  d[[i,"authors.x_002"]] <- str_replace_all(d[[i,"authors.x_002"]],",","")
  d[[i,"authors.x_003"]] <- str_replace_all(d[[i,"authors.x_003"]],",","")
  d[[i,"authors.x_004"]] <- str_replace_all(d[[i,"authors.x_004"]],",","")
  d[[i,"authors.x_005"]] <- str_replace_all(d[[i,"authors.x_005"]],",","")
  d[[i,"authors.x_006"]] <- str_replace_all(d[[i,"authors.x_006"]],",","")
  d[[i,"authors.x_007"]] <- str_replace_all(d[[i,"authors.x_007"]],",","")
  d[[i,"authors.x_008"]] <- str_replace_all(d[[i,"authors.x_008"]],",","")
  d[[i,"authors.x_009"]] <- str_replace_all(d[[i,"authors.x_009"]],",","")
  d[[i,"authors.x_010"]] <- str_replace_all(d[[i,"authors.x_010"]],",","")
  d[[i,"authors.x_011"]] <- str_replace_all(d[[i,"authors.x_011"]],",","")
  d[[i,"authors.x_012"]] <- str_replace_all(d[[i,"authors.x_012"]],",","")
  d[[i,"authors.x_013"]] <- str_replace_all(d[[i,"authors.x_013"]],",","")
  d[[i,"authors.x_014"]] <- str_replace_all(d[[i,"authors.x_014"]],",","")
  d[[i,"authors.x_015"]] <- str_replace_all(d[[i,"authors.x_015"]],",","")
  d[[i,"authors.x_016"]] <- str_replace_all(d[[i,"authors.x_016"]],",","")
  d[[i,"authors.x_017"]] <- str_replace_all(d[[i,"authors.x_017"]],",","")
  d[[i,"authors.x_018"]] <- str_replace_all(d[[i,"authors.x_018"]],",","")
  d[[i,"authors.x_019"]] <- str_replace_all(d[[i,"authors.x_019"]],",","")
  d[[i,"authors.x_020"]] <- str_replace_all(d[[i,"authors.x_020"]],",","")
  d[[i,"authors.x_021"]] <- str_replace_all(d[[i,"authors.x_021"]],",","")
  d[[i,"authors.x_022"]] <- str_replace_all(d[[i,"authors.x_022"]],",","")
  d[[i,"authors.x_023"]] <- str_replace_all(d[[i,"authors.x_023"]],",","")
  d[[i,"authors.x_024"]] <- str_replace_all(d[[i,"authors.x_024"]],",","")
  d[[i,"authors.x_025"]] <- str_replace_all(d[[i,"authors.x_025"]],",","")
  d[[i,"authors.x_026"]] <- str_replace_all(d[[i,"authors.x_026"]],",","")
  d[[i,"authors.x_027"]] <- str_replace_all(d[[i,"authors.x_027"]],",","")
  d[[i,"authors.x_028"]] <- str_replace_all(d[[i,"authors.x_028"]],",","")
  d[[i,"authors.x_029"]] <- str_replace_all(d[[i,"authors.x_029"]],",","")
  d[[i,"authors.x_030"]] <- str_replace_all(d[[i,"authors.x_030"]],",","")
  d[[i,"authors.x_031"]] <- str_replace_all(d[[i,"authors.x_031"]],",","")
  d[[i,"authors.x_032"]] <- str_replace_all(d[[i,"authors.x_032"]],",","")
  d[[i,"authors.x_033"]] <- str_replace_all(d[[i,"authors.x_033"]],",","")
  d[[i,"authors.x_034"]] <- str_replace_all(d[[i,"authors.x_034"]],",","")
  d[[i,"authors.x_035"]] <- str_replace_all(d[[i,"authors.x_035"]],",","")
  d[[i,"authors.x_036"]] <- str_replace_all(d[[i,"authors.x_036"]],",","")
  d[[i,"authors.x_037"]] <- str_replace_all(d[[i,"authors.x_037"]],",","")
  d[[i,"authors.x_038"]] <- str_replace_all(d[[i,"authors.x_038"]],",","")
  d[[i,"authors.x_039"]] <- str_replace_all(d[[i,"authors.x_039"]],",","")
  d[[i,"authors.x_040"]] <- str_replace_all(d[[i,"authors.x_040"]],",","")
  d[[i,"authors.x_041"]] <- str_replace_all(d[[i,"authors.x_041"]],",","")
  d[[i,"authors.x_042"]] <- str_replace_all(d[[i,"authors.x_042"]],",","")
  d[[i,"authors.x_043"]] <- str_replace_all(d[[i,"authors.x_043"]],",","")
  d[[i,"authors.x_044"]] <- str_replace_all(d[[i,"authors.x_044"]],",","")
  d[[i,"authors.x_045"]] <- str_replace_all(d[[i,"authors.x_045"]],",","")
  d[[i,"authors.x_046"]] <- str_replace_all(d[[i,"authors.x_046"]],",","")
  d[[i,"authors.x_047"]] <- str_replace_all(d[[i,"authors.x_047"]],",","")
  d[[i,"authors.x_048"]] <- str_replace_all(d[[i,"authors.x_048"]],",","")
  d[[i,"authors.x_049"]] <- str_replace_all(d[[i,"authors.x_049"]],",","")
  d[[i,"authors.x_050"]] <- str_replace_all(d[[i,"authors.x_050"]],",","")
  d[[i,"authors.x_051"]] <- str_replace_all(d[[i,"authors.x_051"]],",","")
  d[[i,"authors.x_052"]] <- str_replace_all(d[[i,"authors.x_052"]],",","")
  d[[i,"authors.x_053"]] <- str_replace_all(d[[i,"authors.x_053"]],",","")
  d[[i,"authors.x_054"]] <- str_replace_all(d[[i,"authors.x_054"]],",","")
  d[[i,"authors.x_055"]] <- str_replace_all(d[[i,"authors.x_055"]],",","")
  d[[i,"authors.x_056"]] <- str_replace_all(d[[i,"authors.x_056"]],",","")
  d[[i,"authors.x_057"]] <- str_replace_all(d[[i,"authors.x_057"]],",","")
  d[[i,"authors.x_058"]] <- str_replace_all(d[[i,"authors.x_058"]],",","")
  d[[i,"authors.x_059"]] <- str_replace_all(d[[i,"authors.x_059"]],",","")
  d[[i,"authors.x_060"]] <- str_replace_all(d[[i,"authors.x_060"]],",","")
  d[[i,"authors.x_061"]] <- str_replace_all(d[[i,"authors.x_061"]],",","")
  d[[i,"authors.x_062"]] <- str_replace_all(d[[i,"authors.x_062"]],",","")
  d[[i,"authors.x_063"]] <- str_replace_all(d[[i,"authors.x_063"]],",","")
  d[[i,"authors.x_064"]] <- str_replace_all(d[[i,"authors.x_064"]],",","")
  d[[i,"authors.x_065"]] <- str_replace_all(d[[i,"authors.x_065"]],",","")
  d[[i,"authors.x_066"]] <- str_replace_all(d[[i,"authors.x_066"]],",","")
  d[[i,"authors.x_067"]] <- str_replace_all(d[[i,"authors.x_067"]],",","")
  d[[i,"authors.x_068"]] <- str_replace_all(d[[i,"authors.x_068"]],",","")
  d[[i,"authors.x_069"]] <- str_replace_all(d[[i,"authors.x_069"]],",","")
  d[[i,"authors.x_070"]] <- str_replace_all(d[[i,"authors.x_070"]],",","")
  d[[i,"authors.x_071"]] <- str_replace_all(d[[i,"authors.x_071"]],",","")
  d[[i,"authors.x_072"]] <- str_replace_all(d[[i,"authors.x_072"]],",","")
  d[[i,"authors.x_073"]] <- str_replace_all(d[[i,"authors.x_073"]],",","")
  d[[i,"authors.x_074"]] <- str_replace_all(d[[i,"authors.x_074"]],",","")
  d[[i,"authors.x_075"]] <- str_replace_all(d[[i,"authors.x_075"]],",","")
  d[[i,"authors.x_076"]] <- str_replace_all(d[[i,"authors.x_076"]],",","")
  d[[i,"authors.x_077"]] <- str_replace_all(d[[i,"authors.x_077"]],",","")
  d[[i,"authors.x_078"]] <- str_replace_all(d[[i,"authors.x_078"]],",","")
  d[[i,"authors.x_079"]] <- str_replace_all(d[[i,"authors.x_079"]],",","")
  d[[i,"authors.x_080"]] <- str_replace_all(d[[i,"authors.x_080"]],",","")
  d[[i,"authors.x_081"]] <- str_replace_all(d[[i,"authors.x_081"]],",","")
  d[[i,"authors.x_082"]] <- str_replace_all(d[[i,"authors.x_082"]],",","")
  d[[i,"authors.x_083"]] <- str_replace_all(d[[i,"authors.x_083"]],",","")
  d[[i,"authors.x_084"]] <- str_replace_all(d[[i,"authors.x_084"]],",","")
  d[[i,"authors.x_085"]] <- str_replace_all(d[[i,"authors.x_085"]],",","")
  d[[i,"authors.x_086"]] <- str_replace_all(d[[i,"authors.x_086"]],",","")
  d[[i,"authors.x_087"]] <- str_replace_all(d[[i,"authors.x_087"]],",","")
  d[[i,"authors.x_088"]] <- str_replace_all(d[[i,"authors.x_088"]],",","")
  d[[i,"authors.x_089"]] <- str_replace_all(d[[i,"authors.x_089"]],",","")
  d[[i,"authors.x_090"]] <- str_replace_all(d[[i,"authors.x_090"]],",","")
  d[[i,"authors.x_091"]] <- str_replace_all(d[[i,"authors.x_091"]],",","")
  d[[i,"authors.x_092"]] <- str_replace_all(d[[i,"authors.x_092"]],",","")
  d[[i,"authors.x_093"]] <- str_replace_all(d[[i,"authors.x_093"]],",","")
  d[[i,"authors.x_094"]] <- str_replace_all(d[[i,"authors.x_094"]],",","")
  d[[i,"authors.x_095"]] <- str_replace_all(d[[i,"authors.x_095"]],",","")
  d[[i,"authors.x_096"]] <- str_replace_all(d[[i,"authors.x_096"]],",","")
  d[[i,"authors.x_097"]] <- str_replace_all(d[[i,"authors.x_097"]],",","")
  d[[i,"authors.x_098"]] <- str_replace_all(d[[i,"authors.x_098"]],",","")
  d[[i,"authors.x_099"]] <- str_replace_all(d[[i,"authors.x_099"]],",","")
  d[[i,"authors.x_100"]] <- str_replace_all(d[[i,"authors.x_100"]],",","")
  d[[i,"authors.x_101"]] <- str_replace_all(d[[i,"authors.x_101"]],",","")
  d[[i,"authors.x_102"]] <- str_replace_all(d[[i,"authors.x_102"]],",","")
  d[[i,"authors.x_103"]] <- str_replace_all(d[[i,"authors.x_103"]],",","")
  d[[i,"authors.x_104"]] <- str_replace_all(d[[i,"authors.x_104"]],",","")
  d[[i,"authors.x_105"]] <- str_replace_all(d[[i,"authors.x_105"]],",","")
  d[[i,"authors.x_106"]] <- str_replace_all(d[[i,"authors.x_106"]],",","")
  d[[i,"authors.x_107"]] <- str_replace_all(d[[i,"authors.x_107"]],",","")
  d[[i,"authors.x_108"]] <- str_replace_all(d[[i,"authors.x_108"]],",","")
  d[[i,"authors.x_109"]] <- str_replace_all(d[[i,"authors.x_109"]],",","")
  d[[i,"authors.x_110"]] <- str_replace_all(d[[i,"authors.x_110"]],",","")
  d[[i,"authors.x_111"]] <- str_replace_all(d[[i,"authors.x_111"]],",","")
  d[[i,"authors.x_112"]] <- str_replace_all(d[[i,"authors.x_112"]],",","")
  d[[i,"authors.x_113"]] <- str_replace_all(d[[i,"authors.x_113"]],",","")
  d[[i,"authors.x_114"]] <- str_replace_all(d[[i,"authors.x_114"]],",","")
  d[[i,"authors.x_115"]] <- str_replace_all(d[[i,"authors.x_115"]],",","")
  d[[i,"authors.x_116"]] <- str_replace_all(d[[i,"authors.x_116"]],",","")
  d[[i,"authors.x_117"]] <- str_replace_all(d[[i,"authors.x_117"]],",","")
  d[[i,"authors.x_118"]] <- str_replace_all(d[[i,"authors.x_118"]],",","")
  d[[i,"authors.x_119"]] <- str_replace_all(d[[i,"authors.x_119"]],",","")
  d[[i,"authors.x_120"]] <- str_replace_all(d[[i,"authors.x_120"]],",","")
  d[[i,"authors.x_121"]] <- str_replace_all(d[[i,"authors.x_121"]],",","")
  d[[i,"authors.x_122"]] <- str_replace_all(d[[i,"authors.x_122"]],",","")
  d[[i,"authors.x_123"]] <- str_replace_all(d[[i,"authors.x_123"]],",","")
  d[[i,"authors.x_124"]] <- str_replace_all(d[[i,"authors.x_124"]],",","")
  d[[i,"authors.x_125"]] <- str_replace_all(d[[i,"authors.x_125"]],",","")
  d[[i,"authors.x_126"]] <- str_replace_all(d[[i,"authors.x_126"]],",","")
  d[[i,"authors.x_127"]] <- str_replace_all(d[[i,"authors.x_127"]],",","")
  d[[i,"authors.x_128"]] <- str_replace_all(d[[i,"authors.x_128"]],",","")
  d[[i,"authors.x_129"]] <- str_replace_all(d[[i,"authors.x_129"]],",","")
  d[[i,"authors.x_130"]] <- str_replace_all(d[[i,"authors.x_130"]],",","")
  d[[i,"authors.x_131"]] <- str_replace_all(d[[i,"authors.x_131"]],",","")
  d[[i,"authors.x_132"]] <- str_replace_all(d[[i,"authors.x_132"]],",","")
  d[[i,"authors.x_133"]] <- str_replace_all(d[[i,"authors.x_133"]],",","")
  d[[i,"authors.x_134"]] <- str_replace_all(d[[i,"authors.x_134"]],",","")
  d[[i,"authors.x_135"]] <- str_replace_all(d[[i,"authors.x_135"]],",","")
  d[[i,"authors.x_136"]] <- str_replace_all(d[[i,"authors.x_136"]],",","")
  d[[i,"authors.x_137"]] <- str_replace_all(d[[i,"authors.x_137"]],",","")
  d[[i,"authors.x_138"]] <- str_replace_all(d[[i,"authors.x_138"]],",","")
  d[[i,"authors.x_139"]] <- str_replace_all(d[[i,"authors.x_139"]],",","")
  d[[i,"authors.x_140"]] <- str_replace_all(d[[i,"authors.x_140"]],",","")
  d[[i,"authors.x_141"]] <- str_replace_all(d[[i,"authors.x_141"]],",","")
  d[[i,"authors.x_142"]] <- str_replace_all(d[[i,"authors.x_142"]],",","")
  d[[i,"authors.x_143"]] <- str_replace_all(d[[i,"authors.x_143"]],",","")
  d[[i,"authors.x_144"]] <- str_replace_all(d[[i,"authors.x_144"]],",","")
  d[[i,"authors.x_145"]] <- str_replace_all(d[[i,"authors.x_145"]],",","")
  d[[i,"authors.x_146"]] <- str_replace_all(d[[i,"authors.x_146"]],",","")
  d[[i,"authors.x_147"]] <- str_replace_all(d[[i,"authors.x_147"]],",","")
  d[[i,"authors.x_148"]] <- str_replace_all(d[[i,"authors.x_148"]],",","")
  d[[i,"authors.x_149"]] <- str_replace_all(d[[i,"authors.x_149"]],",","")
  d[[i,"authors.x_150"]] <- str_replace_all(d[[i,"authors.x_150"]],",","")
  d[[i,"authors.x_151"]] <- str_replace_all(d[[i,"authors.x_151"]],",","")
  d[[i,"authors.x_152"]] <- str_replace_all(d[[i,"authors.x_152"]],",","")
  d[[i,"authors.x_153"]] <- str_replace_all(d[[i,"authors.x_153"]],",","")
  d[[i,"authors.x_154"]] <- str_replace_all(d[[i,"authors.x_154"]],",","")
  d[[i,"authors.x_155"]] <- str_replace_all(d[[i,"authors.x_155"]],",","")
  d[[i,"authors.x_156"]] <- str_replace_all(d[[i,"authors.x_156"]],",","")
  d[[i,"authors.x_157"]] <- str_replace_all(d[[i,"authors.x_157"]],",","")
  d[[i,"authors.x_158"]] <- str_replace_all(d[[i,"authors.x_158"]],",","")
  d[[i,"authors.x_159"]] <- str_replace_all(d[[i,"authors.x_159"]],",","")
  d[[i,"authors.x_160"]] <- str_replace_all(d[[i,"authors.x_160"]],",","")
  d[[i,"authors.x_161"]] <- str_replace_all(d[[i,"authors.x_161"]],",","")
  d[[i,"authors.x_162"]] <- str_replace_all(d[[i,"authors.x_162"]],",","")
  d[[i,"authors.x_163"]] <- str_replace_all(d[[i,"authors.x_163"]],",","")
  d[[i,"authors.x_164"]] <- str_replace_all(d[[i,"authors.x_164"]],",","")
  d[[i,"authors.x_165"]] <- str_replace_all(d[[i,"authors.x_165"]],",","")
  d[[i,"authors.x_166"]] <- str_replace_all(d[[i,"authors.x_166"]],",","")
  d[[i,"authors.x_167"]] <- str_replace_all(d[[i,"authors.x_167"]],",","")
  d[[i,"authors.x_168"]] <- str_replace_all(d[[i,"authors.x_168"]],",","")
  d[[i,"authors.x_169"]] <- str_replace_all(d[[i,"authors.x_169"]],",","")
  d[[i,"authors.x_170"]] <- str_replace_all(d[[i,"authors.x_170"]],",","")
  d[[i,"authors.x_171"]] <- str_replace_all(d[[i,"authors.x_171"]],",","")
  d[[i,"authors.x_172"]] <- str_replace_all(d[[i,"authors.x_172"]],",","")
  d[[i,"authors.x_173"]] <- str_replace_all(d[[i,"authors.x_173"]],",","")
  d[[i,"authors.x_174"]] <- str_replace_all(d[[i,"authors.x_174"]],",","")
  d[[i,"authors.x_175"]] <- str_replace_all(d[[i,"authors.x_175"]],",","")
  d[[i,"authors.x_176"]] <- str_replace_all(d[[i,"authors.x_176"]],",","")
  d[[i,"authors.x_177"]] <- str_replace_all(d[[i,"authors.x_177"]],",","")
  d[[i,"authors.x_178"]] <- str_replace_all(d[[i,"authors.x_178"]],",","")
  d[[i,"authors.x_179"]] <- str_replace_all(d[[i,"authors.x_179"]],",","")
  d[[i,"authors.x_180"]] <- str_replace_all(d[[i,"authors.x_180"]],",","")
  d[[i,"authors.x_181"]] <- str_replace_all(d[[i,"authors.x_181"]],",","")
  d[[i,"authors.x_182"]] <- str_replace_all(d[[i,"authors.x_182"]],",","")
  d[[i,"authors.x_183"]] <- str_replace_all(d[[i,"authors.x_183"]],",","")
  d[[i,"authors.x_184"]] <- str_replace_all(d[[i,"authors.x_184"]],",","")
  d[[i,"authors.x_185"]] <- str_replace_all(d[[i,"authors.x_185"]],",","")
  d[[i,"authors.x_186"]] <- str_replace_all(d[[i,"authors.x_186"]],",","")
  d[[i,"authors.x_187"]] <- str_replace_all(d[[i,"authors.x_187"]],",","")
  d[[i,"authors.x_188"]] <- str_replace_all(d[[i,"authors.x_188"]],",","")
  d[[i,"authors.x_189"]] <- str_replace_all(d[[i,"authors.x_189"]],",","")
  d[[i,"authors.x_190"]] <- str_replace_all(d[[i,"authors.x_190"]],",","")
  d[[i,"authors.x_191"]] <- str_replace_all(d[[i,"authors.x_191"]],",","")
  d[[i,"authors.x_192"]] <- str_replace_all(d[[i,"authors.x_192"]],",","")
  d[[i,"authors.x_193"]] <- str_replace_all(d[[i,"authors.x_193"]],",","")
  d[[i,"authors.x_194"]] <- str_replace_all(d[[i,"authors.x_194"]],",","")
  d[[i,"authors.x_195"]] <- str_replace_all(d[[i,"authors.x_195"]],",","")
  d[[i,"authors.x_196"]] <- str_replace_all(d[[i,"authors.x_196"]],",","")
  d[[i,"authors.x_197"]] <- str_replace_all(d[[i,"authors.x_197"]],",","")
  d[[i,"authors.x_198"]] <- str_replace_all(d[[i,"authors.x_198"]],",","")
  d[[i,"authors.x_199"]] <- str_replace_all(d[[i,"authors.x_199"]],",","")
  d[[i,"authors.x_200"]] <- str_replace_all(d[[i,"authors.x_200"]],",","")
  d[[i,"authors.x_201"]] <- str_replace_all(d[[i,"authors.x_201"]],",","")
  d[[i,"authors.x_202"]] <- str_replace_all(d[[i,"authors.x_202"]],",","")
  d[[i,"authors.x_203"]] <- str_replace_all(d[[i,"authors.x_203"]],",","")
  d[[i,"authors.x_204"]] <- str_replace_all(d[[i,"authors.x_204"]],",","")
  d[[i,"authors.x_205"]] <- str_replace_all(d[[i,"authors.x_205"]],",","")
  d[[i,"authors.x_206"]] <- str_replace_all(d[[i,"authors.x_206"]],",","")
  d[[i,"authors.x_207"]] <- str_replace_all(d[[i,"authors.x_207"]],",","")
  d[[i,"authors.x_208"]] <- str_replace_all(d[[i,"authors.x_208"]],",","")
  d[[i,"authors.x_209"]] <- str_replace_all(d[[i,"authors.x_209"]],",","")
  d[[i,"authors.x_210"]] <- str_replace_all(d[[i,"authors.x_210"]],",","")
  d[[i,"authors.x_211"]] <- str_replace_all(d[[i,"authors.x_211"]],",","")
  d[[i,"authors.x_212"]] <- str_replace_all(d[[i,"authors.x_212"]],",","")
  d[[i,"authors.x_213"]] <- str_replace_all(d[[i,"authors.x_213"]],",","")
  
  d[[i,"authors.x_001"]] <- str_replace_all(d[[i,"authors.x_001"]],"\\.","")
  d[[i,"authors.x_002"]] <- str_replace_all(d[[i,"authors.x_002"]],"\\.","")
  d[[i,"authors.x_003"]] <- str_replace_all(d[[i,"authors.x_003"]],"\\.","")
  d[[i,"authors.x_004"]] <- str_replace_all(d[[i,"authors.x_004"]],"\\.","")
  d[[i,"authors.x_005"]] <- str_replace_all(d[[i,"authors.x_005"]],"\\.","")
  d[[i,"authors.x_006"]] <- str_replace_all(d[[i,"authors.x_006"]],"\\.","")
  d[[i,"authors.x_007"]] <- str_replace_all(d[[i,"authors.x_007"]],"\\.","")
  d[[i,"authors.x_008"]] <- str_replace_all(d[[i,"authors.x_008"]],"\\.","")
  d[[i,"authors.x_009"]] <- str_replace_all(d[[i,"authors.x_009"]],"\\.","")
  d[[i,"authors.x_010"]] <- str_replace_all(d[[i,"authors.x_010"]],"\\.","")
  d[[i,"authors.x_011"]] <- str_replace_all(d[[i,"authors.x_011"]],"\\.","")
  d[[i,"authors.x_012"]] <- str_replace_all(d[[i,"authors.x_012"]],"\\.","")
  d[[i,"authors.x_013"]] <- str_replace_all(d[[i,"authors.x_013"]],"\\.","")
  d[[i,"authors.x_014"]] <- str_replace_all(d[[i,"authors.x_014"]],"\\.","")
  d[[i,"authors.x_015"]] <- str_replace_all(d[[i,"authors.x_015"]],"\\.","")
  d[[i,"authors.x_016"]] <- str_replace_all(d[[i,"authors.x_016"]],"\\.","")
  d[[i,"authors.x_017"]] <- str_replace_all(d[[i,"authors.x_017"]],"\\.","")
  d[[i,"authors.x_018"]] <- str_replace_all(d[[i,"authors.x_018"]],"\\.","")
  d[[i,"authors.x_019"]] <- str_replace_all(d[[i,"authors.x_019"]],"\\.","")
  d[[i,"authors.x_020"]] <- str_replace_all(d[[i,"authors.x_020"]],"\\.","")
  d[[i,"authors.x_021"]] <- str_replace_all(d[[i,"authors.x_021"]],"\\.","")
  d[[i,"authors.x_022"]] <- str_replace_all(d[[i,"authors.x_022"]],"\\.","")
  d[[i,"authors.x_023"]] <- str_replace_all(d[[i,"authors.x_023"]],"\\.","")
  d[[i,"authors.x_024"]] <- str_replace_all(d[[i,"authors.x_024"]],"\\.","")
  d[[i,"authors.x_025"]] <- str_replace_all(d[[i,"authors.x_025"]],"\\.","")
  d[[i,"authors.x_026"]] <- str_replace_all(d[[i,"authors.x_026"]],"\\.","")
  d[[i,"authors.x_027"]] <- str_replace_all(d[[i,"authors.x_027"]],"\\.","")
  d[[i,"authors.x_028"]] <- str_replace_all(d[[i,"authors.x_028"]],"\\.","")
  d[[i,"authors.x_029"]] <- str_replace_all(d[[i,"authors.x_029"]],"\\.","")
  d[[i,"authors.x_030"]] <- str_replace_all(d[[i,"authors.x_030"]],"\\.","")
  d[[i,"authors.x_031"]] <- str_replace_all(d[[i,"authors.x_031"]],"\\.","")
  d[[i,"authors.x_032"]] <- str_replace_all(d[[i,"authors.x_032"]],"\\.","")
  d[[i,"authors.x_033"]] <- str_replace_all(d[[i,"authors.x_033"]],"\\.","")
  d[[i,"authors.x_034"]] <- str_replace_all(d[[i,"authors.x_034"]],"\\.","")
  d[[i,"authors.x_035"]] <- str_replace_all(d[[i,"authors.x_035"]],"\\.","")
  d[[i,"authors.x_036"]] <- str_replace_all(d[[i,"authors.x_036"]],"\\.","")
  d[[i,"authors.x_037"]] <- str_replace_all(d[[i,"authors.x_037"]],"\\.","")
  d[[i,"authors.x_038"]] <- str_replace_all(d[[i,"authors.x_038"]],"\\.","")
  d[[i,"authors.x_039"]] <- str_replace_all(d[[i,"authors.x_039"]],"\\.","")
  d[[i,"authors.x_040"]] <- str_replace_all(d[[i,"authors.x_040"]],"\\.","")
  d[[i,"authors.x_041"]] <- str_replace_all(d[[i,"authors.x_041"]],"\\.","")
  d[[i,"authors.x_042"]] <- str_replace_all(d[[i,"authors.x_042"]],"\\.","")
  d[[i,"authors.x_043"]] <- str_replace_all(d[[i,"authors.x_043"]],"\\.","")
  d[[i,"authors.x_044"]] <- str_replace_all(d[[i,"authors.x_044"]],"\\.","")
  d[[i,"authors.x_045"]] <- str_replace_all(d[[i,"authors.x_045"]],"\\.","")
  d[[i,"authors.x_046"]] <- str_replace_all(d[[i,"authors.x_046"]],"\\.","")
  d[[i,"authors.x_047"]] <- str_replace_all(d[[i,"authors.x_047"]],"\\.","")
  d[[i,"authors.x_048"]] <- str_replace_all(d[[i,"authors.x_048"]],"\\.","")
  d[[i,"authors.x_049"]] <- str_replace_all(d[[i,"authors.x_049"]],"\\.","")
  d[[i,"authors.x_050"]] <- str_replace_all(d[[i,"authors.x_050"]],"\\.","")
  d[[i,"authors.x_051"]] <- str_replace_all(d[[i,"authors.x_051"]],"\\.","")
  d[[i,"authors.x_052"]] <- str_replace_all(d[[i,"authors.x_052"]],"\\.","")
  d[[i,"authors.x_053"]] <- str_replace_all(d[[i,"authors.x_053"]],"\\.","")
  d[[i,"authors.x_054"]] <- str_replace_all(d[[i,"authors.x_054"]],"\\.","")
  d[[i,"authors.x_055"]] <- str_replace_all(d[[i,"authors.x_055"]],"\\.","")
  d[[i,"authors.x_056"]] <- str_replace_all(d[[i,"authors.x_056"]],"\\.","")
  d[[i,"authors.x_057"]] <- str_replace_all(d[[i,"authors.x_057"]],"\\.","")
  d[[i,"authors.x_058"]] <- str_replace_all(d[[i,"authors.x_058"]],"\\.","")
  d[[i,"authors.x_059"]] <- str_replace_all(d[[i,"authors.x_059"]],"\\.","")
  d[[i,"authors.x_060"]] <- str_replace_all(d[[i,"authors.x_060"]],"\\.","")
  d[[i,"authors.x_061"]] <- str_replace_all(d[[i,"authors.x_061"]],"\\.","")
  d[[i,"authors.x_062"]] <- str_replace_all(d[[i,"authors.x_062"]],"\\.","")
  d[[i,"authors.x_063"]] <- str_replace_all(d[[i,"authors.x_063"]],"\\.","")
  d[[i,"authors.x_064"]] <- str_replace_all(d[[i,"authors.x_064"]],"\\.","")
  d[[i,"authors.x_065"]] <- str_replace_all(d[[i,"authors.x_065"]],"\\.","")
  d[[i,"authors.x_066"]] <- str_replace_all(d[[i,"authors.x_066"]],"\\.","")
  d[[i,"authors.x_067"]] <- str_replace_all(d[[i,"authors.x_067"]],"\\.","")
  d[[i,"authors.x_068"]] <- str_replace_all(d[[i,"authors.x_068"]],"\\.","")
  d[[i,"authors.x_069"]] <- str_replace_all(d[[i,"authors.x_069"]],"\\.","")
  d[[i,"authors.x_070"]] <- str_replace_all(d[[i,"authors.x_070"]],"\\.","")
  d[[i,"authors.x_071"]] <- str_replace_all(d[[i,"authors.x_071"]],"\\.","")
  d[[i,"authors.x_072"]] <- str_replace_all(d[[i,"authors.x_072"]],"\\.","")
  d[[i,"authors.x_073"]] <- str_replace_all(d[[i,"authors.x_073"]],"\\.","")
  d[[i,"authors.x_074"]] <- str_replace_all(d[[i,"authors.x_074"]],"\\.","")
  d[[i,"authors.x_075"]] <- str_replace_all(d[[i,"authors.x_075"]],"\\.","")
  d[[i,"authors.x_076"]] <- str_replace_all(d[[i,"authors.x_076"]],"\\.","")
  d[[i,"authors.x_077"]] <- str_replace_all(d[[i,"authors.x_077"]],"\\.","")
  d[[i,"authors.x_078"]] <- str_replace_all(d[[i,"authors.x_078"]],"\\.","")
  d[[i,"authors.x_079"]] <- str_replace_all(d[[i,"authors.x_079"]],"\\.","")
  d[[i,"authors.x_080"]] <- str_replace_all(d[[i,"authors.x_080"]],"\\.","")
  d[[i,"authors.x_081"]] <- str_replace_all(d[[i,"authors.x_081"]],"\\.","")
  d[[i,"authors.x_082"]] <- str_replace_all(d[[i,"authors.x_082"]],"\\.","")
  d[[i,"authors.x_083"]] <- str_replace_all(d[[i,"authors.x_083"]],"\\.","")
  d[[i,"authors.x_084"]] <- str_replace_all(d[[i,"authors.x_084"]],"\\.","")
  d[[i,"authors.x_085"]] <- str_replace_all(d[[i,"authors.x_085"]],"\\.","")
  d[[i,"authors.x_086"]] <- str_replace_all(d[[i,"authors.x_086"]],"\\.","")
  d[[i,"authors.x_087"]] <- str_replace_all(d[[i,"authors.x_087"]],"\\.","")
  d[[i,"authors.x_088"]] <- str_replace_all(d[[i,"authors.x_088"]],"\\.","")
  d[[i,"authors.x_089"]] <- str_replace_all(d[[i,"authors.x_089"]],"\\.","")
  d[[i,"authors.x_090"]] <- str_replace_all(d[[i,"authors.x_090"]],"\\.","")
  d[[i,"authors.x_091"]] <- str_replace_all(d[[i,"authors.x_091"]],"\\.","")
  d[[i,"authors.x_092"]] <- str_replace_all(d[[i,"authors.x_092"]],"\\.","")
  d[[i,"authors.x_093"]] <- str_replace_all(d[[i,"authors.x_093"]],"\\.","")
  d[[i,"authors.x_094"]] <- str_replace_all(d[[i,"authors.x_094"]],"\\.","")
  d[[i,"authors.x_095"]] <- str_replace_all(d[[i,"authors.x_095"]],"\\.","")
  d[[i,"authors.x_096"]] <- str_replace_all(d[[i,"authors.x_096"]],"\\.","")
  d[[i,"authors.x_097"]] <- str_replace_all(d[[i,"authors.x_097"]],"\\.","")
  d[[i,"authors.x_098"]] <- str_replace_all(d[[i,"authors.x_098"]],"\\.","")
  d[[i,"authors.x_099"]] <- str_replace_all(d[[i,"authors.x_099"]],"\\.","")
  d[[i,"authors.x_100"]] <- str_replace_all(d[[i,"authors.x_100"]],"\\.","")
  d[[i,"authors.x_101"]] <- str_replace_all(d[[i,"authors.x_101"]],"\\.","")
  d[[i,"authors.x_102"]] <- str_replace_all(d[[i,"authors.x_102"]],"\\.","")
  d[[i,"authors.x_103"]] <- str_replace_all(d[[i,"authors.x_103"]],"\\.","")
  d[[i,"authors.x_104"]] <- str_replace_all(d[[i,"authors.x_104"]],"\\.","")
  d[[i,"authors.x_105"]] <- str_replace_all(d[[i,"authors.x_105"]],"\\.","")
  d[[i,"authors.x_106"]] <- str_replace_all(d[[i,"authors.x_106"]],"\\.","")
  d[[i,"authors.x_107"]] <- str_replace_all(d[[i,"authors.x_107"]],"\\.","")
  d[[i,"authors.x_108"]] <- str_replace_all(d[[i,"authors.x_108"]],"\\.","")
  d[[i,"authors.x_109"]] <- str_replace_all(d[[i,"authors.x_109"]],"\\.","")
  d[[i,"authors.x_110"]] <- str_replace_all(d[[i,"authors.x_110"]],"\\.","")
  d[[i,"authors.x_111"]] <- str_replace_all(d[[i,"authors.x_111"]],"\\.","")
  d[[i,"authors.x_112"]] <- str_replace_all(d[[i,"authors.x_112"]],"\\.","")
  d[[i,"authors.x_113"]] <- str_replace_all(d[[i,"authors.x_113"]],"\\.","")
  d[[i,"authors.x_114"]] <- str_replace_all(d[[i,"authors.x_114"]],"\\.","")
  d[[i,"authors.x_115"]] <- str_replace_all(d[[i,"authors.x_115"]],"\\.","")
  d[[i,"authors.x_116"]] <- str_replace_all(d[[i,"authors.x_116"]],"\\.","")
  d[[i,"authors.x_117"]] <- str_replace_all(d[[i,"authors.x_117"]],"\\.","")
  d[[i,"authors.x_118"]] <- str_replace_all(d[[i,"authors.x_118"]],"\\.","")
  d[[i,"authors.x_119"]] <- str_replace_all(d[[i,"authors.x_119"]],"\\.","")
  d[[i,"authors.x_120"]] <- str_replace_all(d[[i,"authors.x_120"]],"\\.","")
  d[[i,"authors.x_121"]] <- str_replace_all(d[[i,"authors.x_121"]],"\\.","")
  d[[i,"authors.x_122"]] <- str_replace_all(d[[i,"authors.x_122"]],"\\.","")
  d[[i,"authors.x_123"]] <- str_replace_all(d[[i,"authors.x_123"]],"\\.","")
  d[[i,"authors.x_124"]] <- str_replace_all(d[[i,"authors.x_124"]],"\\.","")
  d[[i,"authors.x_125"]] <- str_replace_all(d[[i,"authors.x_125"]],"\\.","")
  d[[i,"authors.x_126"]] <- str_replace_all(d[[i,"authors.x_126"]],"\\.","")
  d[[i,"authors.x_127"]] <- str_replace_all(d[[i,"authors.x_127"]],"\\.","")
  d[[i,"authors.x_128"]] <- str_replace_all(d[[i,"authors.x_128"]],"\\.","")
  d[[i,"authors.x_129"]] <- str_replace_all(d[[i,"authors.x_129"]],"\\.","")
  d[[i,"authors.x_130"]] <- str_replace_all(d[[i,"authors.x_130"]],"\\.","")
  d[[i,"authors.x_131"]] <- str_replace_all(d[[i,"authors.x_131"]],"\\.","")
  d[[i,"authors.x_132"]] <- str_replace_all(d[[i,"authors.x_132"]],"\\.","")
  d[[i,"authors.x_133"]] <- str_replace_all(d[[i,"authors.x_133"]],"\\.","")
  d[[i,"authors.x_134"]] <- str_replace_all(d[[i,"authors.x_134"]],"\\.","")
  d[[i,"authors.x_135"]] <- str_replace_all(d[[i,"authors.x_135"]],"\\.","")
  d[[i,"authors.x_136"]] <- str_replace_all(d[[i,"authors.x_136"]],"\\.","")
  d[[i,"authors.x_137"]] <- str_replace_all(d[[i,"authors.x_137"]],"\\.","")
  d[[i,"authors.x_138"]] <- str_replace_all(d[[i,"authors.x_138"]],"\\.","")
  d[[i,"authors.x_139"]] <- str_replace_all(d[[i,"authors.x_139"]],"\\.","")
  d[[i,"authors.x_140"]] <- str_replace_all(d[[i,"authors.x_140"]],"\\.","")
  d[[i,"authors.x_141"]] <- str_replace_all(d[[i,"authors.x_141"]],"\\.","")
  d[[i,"authors.x_142"]] <- str_replace_all(d[[i,"authors.x_142"]],"\\.","")
  d[[i,"authors.x_143"]] <- str_replace_all(d[[i,"authors.x_143"]],"\\.","")
  d[[i,"authors.x_144"]] <- str_replace_all(d[[i,"authors.x_144"]],"\\.","")
  d[[i,"authors.x_145"]] <- str_replace_all(d[[i,"authors.x_145"]],"\\.","")
  d[[i,"authors.x_146"]] <- str_replace_all(d[[i,"authors.x_146"]],"\\.","")
  d[[i,"authors.x_147"]] <- str_replace_all(d[[i,"authors.x_147"]],"\\.","")
  d[[i,"authors.x_148"]] <- str_replace_all(d[[i,"authors.x_148"]],"\\.","")
  d[[i,"authors.x_149"]] <- str_replace_all(d[[i,"authors.x_149"]],"\\.","")
  d[[i,"authors.x_150"]] <- str_replace_all(d[[i,"authors.x_150"]],"\\.","")
  d[[i,"authors.x_151"]] <- str_replace_all(d[[i,"authors.x_151"]],"\\.","")
  d[[i,"authors.x_152"]] <- str_replace_all(d[[i,"authors.x_152"]],"\\.","")
  d[[i,"authors.x_153"]] <- str_replace_all(d[[i,"authors.x_153"]],"\\.","")
  d[[i,"authors.x_154"]] <- str_replace_all(d[[i,"authors.x_154"]],"\\.","")
  d[[i,"authors.x_155"]] <- str_replace_all(d[[i,"authors.x_155"]],"\\.","")
  d[[i,"authors.x_156"]] <- str_replace_all(d[[i,"authors.x_156"]],"\\.","")
  d[[i,"authors.x_157"]] <- str_replace_all(d[[i,"authors.x_157"]],"\\.","")
  d[[i,"authors.x_158"]] <- str_replace_all(d[[i,"authors.x_158"]],"\\.","")
  d[[i,"authors.x_159"]] <- str_replace_all(d[[i,"authors.x_159"]],"\\.","")
  d[[i,"authors.x_160"]] <- str_replace_all(d[[i,"authors.x_160"]],"\\.","")
  d[[i,"authors.x_161"]] <- str_replace_all(d[[i,"authors.x_161"]],"\\.","")
  d[[i,"authors.x_162"]] <- str_replace_all(d[[i,"authors.x_162"]],"\\.","")
  d[[i,"authors.x_163"]] <- str_replace_all(d[[i,"authors.x_163"]],"\\.","")
  d[[i,"authors.x_164"]] <- str_replace_all(d[[i,"authors.x_164"]],"\\.","")
  d[[i,"authors.x_165"]] <- str_replace_all(d[[i,"authors.x_165"]],"\\.","")
  d[[i,"authors.x_166"]] <- str_replace_all(d[[i,"authors.x_166"]],"\\.","")
  d[[i,"authors.x_167"]] <- str_replace_all(d[[i,"authors.x_167"]],"\\.","")
  d[[i,"authors.x_168"]] <- str_replace_all(d[[i,"authors.x_168"]],"\\.","")
  d[[i,"authors.x_169"]] <- str_replace_all(d[[i,"authors.x_169"]],"\\.","")
  d[[i,"authors.x_170"]] <- str_replace_all(d[[i,"authors.x_170"]],"\\.","")
  d[[i,"authors.x_171"]] <- str_replace_all(d[[i,"authors.x_171"]],"\\.","")
  d[[i,"authors.x_172"]] <- str_replace_all(d[[i,"authors.x_172"]],"\\.","")
  d[[i,"authors.x_173"]] <- str_replace_all(d[[i,"authors.x_173"]],"\\.","")
  d[[i,"authors.x_174"]] <- str_replace_all(d[[i,"authors.x_174"]],"\\.","")
  d[[i,"authors.x_175"]] <- str_replace_all(d[[i,"authors.x_175"]],"\\.","")
  d[[i,"authors.x_176"]] <- str_replace_all(d[[i,"authors.x_176"]],"\\.","")
  d[[i,"authors.x_177"]] <- str_replace_all(d[[i,"authors.x_177"]],"\\.","")
  d[[i,"authors.x_178"]] <- str_replace_all(d[[i,"authors.x_178"]],"\\.","")
  d[[i,"authors.x_179"]] <- str_replace_all(d[[i,"authors.x_179"]],"\\.","")
  d[[i,"authors.x_180"]] <- str_replace_all(d[[i,"authors.x_180"]],"\\.","")
  d[[i,"authors.x_181"]] <- str_replace_all(d[[i,"authors.x_181"]],"\\.","")
  d[[i,"authors.x_182"]] <- str_replace_all(d[[i,"authors.x_182"]],"\\.","")
  d[[i,"authors.x_183"]] <- str_replace_all(d[[i,"authors.x_183"]],"\\.","")
  d[[i,"authors.x_184"]] <- str_replace_all(d[[i,"authors.x_184"]],"\\.","")
  d[[i,"authors.x_185"]] <- str_replace_all(d[[i,"authors.x_185"]],"\\.","")
  d[[i,"authors.x_186"]] <- str_replace_all(d[[i,"authors.x_186"]],"\\.","")
  d[[i,"authors.x_187"]] <- str_replace_all(d[[i,"authors.x_187"]],"\\.","")
  d[[i,"authors.x_188"]] <- str_replace_all(d[[i,"authors.x_188"]],"\\.","")
  d[[i,"authors.x_189"]] <- str_replace_all(d[[i,"authors.x_189"]],"\\.","")
  d[[i,"authors.x_190"]] <- str_replace_all(d[[i,"authors.x_190"]],"\\.","")
  d[[i,"authors.x_191"]] <- str_replace_all(d[[i,"authors.x_191"]],"\\.","")
  d[[i,"authors.x_192"]] <- str_replace_all(d[[i,"authors.x_192"]],"\\.","")
  d[[i,"authors.x_193"]] <- str_replace_all(d[[i,"authors.x_193"]],"\\.","")
  d[[i,"authors.x_194"]] <- str_replace_all(d[[i,"authors.x_194"]],"\\.","")
  d[[i,"authors.x_195"]] <- str_replace_all(d[[i,"authors.x_195"]],"\\.","")
  d[[i,"authors.x_196"]] <- str_replace_all(d[[i,"authors.x_196"]],"\\.","")
  d[[i,"authors.x_197"]] <- str_replace_all(d[[i,"authors.x_197"]],"\\.","")
  d[[i,"authors.x_198"]] <- str_replace_all(d[[i,"authors.x_198"]],"\\.","")
  d[[i,"authors.x_199"]] <- str_replace_all(d[[i,"authors.x_199"]],"\\.","")
  d[[i,"authors.x_200"]] <- str_replace_all(d[[i,"authors.x_200"]],"\\.","")
  d[[i,"authors.x_201"]] <- str_replace_all(d[[i,"authors.x_201"]],"\\.","")
  d[[i,"authors.x_202"]] <- str_replace_all(d[[i,"authors.x_202"]],"\\.","")
  d[[i,"authors.x_203"]] <- str_replace_all(d[[i,"authors.x_203"]],"\\.","")
  d[[i,"authors.x_204"]] <- str_replace_all(d[[i,"authors.x_204"]],"\\.","")
  d[[i,"authors.x_205"]] <- str_replace_all(d[[i,"authors.x_205"]],"\\.","")
  d[[i,"authors.x_206"]] <- str_replace_all(d[[i,"authors.x_206"]],"\\.","")
  d[[i,"authors.x_207"]] <- str_replace_all(d[[i,"authors.x_207"]],"\\.","")
  d[[i,"authors.x_208"]] <- str_replace_all(d[[i,"authors.x_208"]],"\\.","")
  d[[i,"authors.x_209"]] <- str_replace_all(d[[i,"authors.x_209"]],"\\.","")
  d[[i,"authors.x_210"]] <- str_replace_all(d[[i,"authors.x_210"]],"\\.","")
  d[[i,"authors.x_211"]] <- str_replace_all(d[[i,"authors.x_211"]],"\\.","")
  d[[i,"authors.x_212"]] <- str_replace_all(d[[i,"authors.x_212"]],"\\.","")
  d[[i,"authors.x_213"]] <- str_replace_all(d[[i,"authors.x_213"]],"\\.","")
  
}

for (i in 1:nrow(d)) {
  
  for (j in 1:213) {
    author_num <- sprintf("%03d", j)
    if(nchar(d[[i,paste0("authors.x_", author_num)]])!= 0) {
      ifelse(grepl(d[[i,paste0("authors.x_", author_num)]], d[[i,"authors.y"]]),d[[i,"overlapping_names"]] <- paste(d[[i,"overlapping_names"]],d[[i,paste0("authors.x_", author_num)]]),d[[i,"non_overlapping_names"]] <- paste(d[[i,"non_overlapping_names"]],d[[i,paste0("authors.x_", author_num)]]))
      if(grepl(d[[i,paste0("authors.x_", author_num)]], d[[i,"authors.y"]])) {
        d[[i,"authors.y_dup"]] <- str_replace(d[[i,"authors.y_dup"]], d[[i,paste0("authors.x_", author_num)]], "")
      }
    }
  }
  
  d[[i,"non_overlapping_names"]] <- paste(d[[i,"non_overlapping_names"]],d[[i,"authors.y_dup"]])
  d[[i,"non_overlapping_names"]] <- str_replace_all(d[[i,"non_overlapping_names"]],"\t"," ")
  d[[i,"non_overlapping_names"]] <- str_replace_all(d[[i,"non_overlapping_names"]],"  "," ")
  d[[i,"non_overlapping_names"]] <- str_replace_all(d[[i,"non_overlapping_names"]],"  "," ")
  
  d[[i,"non_overlapping_names"]] <- str_trim(d[[i,"non_overlapping_names"]]) 
  d[[i,"overlapping_names"]] <- str_trim(d[[i,"overlapping_names"]])
  
  d[[i,"count_non_overlapping_names"]] <- sapply(strsplit(d[[i,"non_overlapping_names"]], " "), length)
  d[[i,"count_overlapping_names"]] <- sapply(strsplit(d[[i,"overlapping_names"]], " "), length)
  
}

# write.csv(d, "GB_NIH_TOTAL_COST_subset_authoroverlap_new_method.csv", row.names = TRUE)

############################################################
# Install and load the necessary packages
# install.packages("tidyverse")
# install.packages("splitstackshape")
# install.packages("dplyr")
# install.packages("stringr")
# install.packages("gdata")
# install.packages("tidyr") 

library(tidyverse)
library(splitstackshape)
library(dplyr)
library(stringr)
library(tidyr) 

options(max.print=1000000)

setwd("/groups/sebratt")

# Load the dataset into a variable
d <- read.csv("ref_index_merge.csv")

# Subset the tibble according to the batch size 
d <- d %>% filter(year_etc.y == '2020' | year_etc.y == '2021')

# setwd("/groups/sebratt")
# write.csv(d, "sample.csv", row.names = TRUE)

# Clean data by removing any special characters that may have creeped in
d$authors.x <- str_replace_all(d$authors.x,"\\*","")
d$authors.x <- str_replace_all(d$authors.x,"#","")
d$authors.x <- str_replace_all(d$authors.x,"@","")
d$authors.x <- str_replace_all(d$authors.x,"\t"," ")
d$authors.x <- str_replace_all(d$authors.x,"\t"," ")
d$authors.x <- str_replace_all(d$authors.x,"  "," ")

d$authors.y <- str_replace_all(d$authors.y,"\\*","")
d$authors.y <- str_replace_all(d$authors.y,"#","")
d$authors.y <- str_replace_all(d$authors.y,"@","")
d$authors.y <- str_replace_all(d$authors.y,"\t"," ")

# Replace the " and" in the authors.x column with a single comma ","
d$authors.x <- gsub(" and",",", d$authors.x) 
d$authors.x <- gsub(" and ",",", d$authors.x)
d$authors.x <- gsub("and ",",", d$authors.x)

# Adding new columns to the tibble where the overlapping and non-overlapping names will be stored,
# as well as duplicate the authors.y column
d <- d %>% 
  add_column(overlapping_names = "")
d <- d %>% 
  add_column(non_overlapping_names = "")
d <- d %>% 
  add_column(authors.y_dup = "")

d$authors.y_dup <- d$authors.y

d <- d %>% 
  add_column(authors.y_dup2 = "")
d$authors.y_dup2 <- d$authors.y

d <- d %>% 
  add_column(count_overlapping_names = 0)

d <- d %>% 
  add_column(count_non_overlapping_names = 0)

# Split the authors.x column to split authors into individual columns
d <- cSplit(d, "authors.x", ".,",'wide')
# d <- cSplit(d, "authors.y", ".,",'wide')

# Replace the " and" in the authors.y column with a single comma ","
d$authors.y<- gsub(" and",",", d$authors.y) 
d$authors.y <- gsub(" and ",",", d$authors.y)
d$authors.y <- gsub("and ",",", d$authors.y)
d <- d %>% replace_na(list(authors.y = ""))


# Replace the " and" in the authors.y_dup column with a single comma ","
d$authors.y_dup<- gsub(" and",",", d$authors.y_dup) 
d$authors.y_dup <- gsub(" and ",",", d$authors.y_dup)
d$authors.y_dup <- gsub("and ",",", d$authors.y_dup)
d <- d %>% replace_na(list(authors.y_dup = ""))


# Replace NAs in each author column with an empty string, so that no errors associated
# with NAs show up in string operations
d <- d %>% replace_na(list(authors.x_001 = ""))
d <- d %>% replace_na(list(authors.x_002 = ""))
d <- d %>% replace_na(list(authors.x_003 = ""))
d <- d %>% replace_na(list(authors.x_004 = ""))
d <- d %>% replace_na(list(authors.x_005 = ""))
d <- d %>% replace_na(list(authors.x_006 = ""))
d <- d %>% replace_na(list(authors.x_007 = ""))
d <- d %>% replace_na(list(authors.x_008 = ""))
d <- d %>% replace_na(list(authors.x_009 = ""))
d <- d %>% replace_na(list(authors.x_010 = ""))
d <- d %>% replace_na(list(authors.x_011 = ""))
d <- d %>% replace_na(list(authors.x_012 = ""))
d <- d %>% replace_na(list(authors.x_013 = ""))
d <- d %>% replace_na(list(authors.x_014 = ""))
d <- d %>% replace_na(list(authors.x_015 = ""))
d <- d %>% replace_na(list(authors.x_016 = ""))
d <- d %>% replace_na(list(authors.x_017 = ""))
d <- d %>% replace_na(list(authors.x_018 = ""))
d <- d %>% replace_na(list(authors.x_019 = ""))
d <- d %>% replace_na(list(authors.x_020 = ""))
d <- d %>% replace_na(list(authors.x_021 = ""))
d <- d %>% replace_na(list(authors.x_022 = ""))
d <- d %>% replace_na(list(authors.x_023 = ""))
d <- d %>% replace_na(list(authors.x_024 = ""))
d <- d %>% replace_na(list(authors.x_025 = ""))
d <- d %>% replace_na(list(authors.x_026 = ""))
d <- d %>% replace_na(list(authors.x_027 = ""))
d <- d %>% replace_na(list(authors.x_028 = ""))
d <- d %>% replace_na(list(authors.x_029 = ""))
d <- d %>% replace_na(list(authors.x_030 = ""))
d <- d %>% replace_na(list(authors.x_031 = ""))
d <- d %>% replace_na(list(authors.x_032 = ""))
d <- d %>% replace_na(list(authors.x_033 = ""))
d <- d %>% replace_na(list(authors.x_034 = ""))
d <- d %>% replace_na(list(authors.x_035 = ""))
d <- d %>% replace_na(list(authors.x_036 = ""))
d <- d %>% replace_na(list(authors.x_037 = ""))
d <- d %>% replace_na(list(authors.x_038 = ""))
d <- d %>% replace_na(list(authors.x_039 = ""))
d <- d %>% replace_na(list(authors.x_040 = ""))
d <- d %>% replace_na(list(authors.x_041 = ""))
d <- d %>% replace_na(list(authors.x_042 = ""))
d <- d %>% replace_na(list(authors.x_043 = ""))
d <- d %>% replace_na(list(authors.x_044 = ""))
d <- d %>% replace_na(list(authors.x_045 = ""))
d <- d %>% replace_na(list(authors.x_046 = ""))
d <- d %>% replace_na(list(authors.x_047 = ""))
d <- d %>% replace_na(list(authors.x_048 = ""))
d <- d %>% replace_na(list(authors.x_049 = ""))
d <- d %>% replace_na(list(authors.x_050 = ""))
d <- d %>% replace_na(list(authors.x_051 = ""))
d <- d %>% replace_na(list(authors.x_052 = ""))
d <- d %>% replace_na(list(authors.x_053 = ""))
d <- d %>% replace_na(list(authors.x_054 = ""))
d <- d %>% replace_na(list(authors.x_055 = ""))
d <- d %>% replace_na(list(authors.x_056 = ""))
d <- d %>% replace_na(list(authors.x_057 = ""))
d <- d %>% replace_na(list(authors.x_058 = ""))
d <- d %>% replace_na(list(authors.x_059 = ""))
d <- d %>% replace_na(list(authors.x_060 = ""))
d <- d %>% replace_na(list(authors.x_061 = ""))
d <- d %>% replace_na(list(authors.x_062 = ""))
d <- d %>% replace_na(list(authors.x_063 = ""))
d <- d %>% replace_na(list(authors.x_064 = ""))
d <- d %>% replace_na(list(authors.x_065 = ""))
d <- d %>% replace_na(list(authors.x_066 = ""))
d <- d %>% replace_na(list(authors.x_067 = ""))
d <- d %>% replace_na(list(authors.x_068 = ""))
d <- d %>% replace_na(list(authors.x_069 = ""))
d <- d %>% replace_na(list(authors.x_070 = ""))
d <- d %>% replace_na(list(authors.x_071 = ""))
d <- d %>% replace_na(list(authors.x_072 = ""))
d <- d %>% replace_na(list(authors.x_073 = ""))
d <- d %>% replace_na(list(authors.x_074 = ""))
d <- d %>% replace_na(list(authors.x_075 = ""))
d <- d %>% replace_na(list(authors.x_076 = ""))
d <- d %>% replace_na(list(authors.x_077 = ""))
d <- d %>% replace_na(list(authors.x_078 = ""))
d <- d %>% replace_na(list(authors.x_079 = ""))
d <- d %>% replace_na(list(authors.x_080 = ""))
d <- d %>% replace_na(list(authors.x_081 = ""))
d <- d %>% replace_na(list(authors.x_082 = ""))
d <- d %>% replace_na(list(authors.x_083 = ""))
d <- d %>% replace_na(list(authors.x_084 = ""))
d <- d %>% replace_na(list(authors.x_085 = ""))
d <- d %>% replace_na(list(authors.x_086 = ""))
d <- d %>% replace_na(list(authors.x_087 = ""))
d <- d %>% replace_na(list(authors.x_088 = ""))
d <- d %>% replace_na(list(authors.x_089 = ""))
d <- d %>% replace_na(list(authors.x_090 = ""))
d <- d %>% replace_na(list(authors.x_091 = ""))
d <- d %>% replace_na(list(authors.x_092 = ""))
d <- d %>% replace_na(list(authors.x_093 = ""))
d <- d %>% replace_na(list(authors.x_094 = ""))
d <- d %>% replace_na(list(authors.x_095 = ""))
d <- d %>% replace_na(list(authors.x_096 = ""))
d <- d %>% replace_na(list(authors.x_097 = ""))
d <- d %>% replace_na(list(authors.x_098 = ""))
d <- d %>% replace_na(list(authors.x_099 = ""))
d <- d %>% replace_na(list(authors.x_100 = ""))
d <- d %>% replace_na(list(authors.x_101 = ""))
d <- d %>% replace_na(list(authors.x_102 = ""))
d <- d %>% replace_na(list(authors.x_103 = ""))
d <- d %>% replace_na(list(authors.x_104 = ""))
d <- d %>% replace_na(list(authors.x_105 = ""))
d <- d %>% replace_na(list(authors.x_106 = ""))
d <- d %>% replace_na(list(authors.x_107 = ""))
d <- d %>% replace_na(list(authors.x_108 = ""))
d <- d %>% replace_na(list(authors.x_109 = ""))
d <- d %>% replace_na(list(authors.x_110 = ""))
d <- d %>% replace_na(list(authors.x_111 = ""))
d <- d %>% replace_na(list(authors.x_112 = ""))
d <- d %>% replace_na(list(authors.x_113 = ""))
d <- d %>% replace_na(list(authors.x_114 = ""))
d <- d %>% replace_na(list(authors.x_115 = ""))
d <- d %>% replace_na(list(authors.x_116 = ""))
d <- d %>% replace_na(list(authors.x_117 = ""))
d <- d %>% replace_na(list(authors.x_118 = ""))
d <- d %>% replace_na(list(authors.x_119 = ""))
d <- d %>% replace_na(list(authors.x_120 = ""))
d <- d %>% replace_na(list(authors.x_121 = ""))
d <- d %>% replace_na(list(authors.x_122 = ""))
d <- d %>% replace_na(list(authors.x_123 = ""))
d <- d %>% replace_na(list(authors.x_124 = ""))
d <- d %>% replace_na(list(authors.x_125 = ""))
d <- d %>% replace_na(list(authors.x_126 = ""))
d <- d %>% replace_na(list(authors.x_127 = ""))
d <- d %>% replace_na(list(authors.x_128 = ""))
d <- d %>% replace_na(list(authors.x_129 = ""))
d <- d %>% replace_na(list(authors.x_130 = ""))
d <- d %>% replace_na(list(authors.x_131 = ""))
d <- d %>% replace_na(list(authors.x_132 = ""))
d <- d %>% replace_na(list(authors.x_133 = ""))
d <- d %>% replace_na(list(authors.x_134 = ""))
d <- d %>% replace_na(list(authors.x_135 = ""))
d <- d %>% replace_na(list(authors.x_136 = ""))
d <- d %>% replace_na(list(authors.x_137 = ""))
d <- d %>% replace_na(list(authors.x_138 = ""))
d <- d %>% replace_na(list(authors.x_139 = ""))
d <- d %>% replace_na(list(authors.x_140 = ""))
d <- d %>% replace_na(list(authors.x_141 = ""))
d <- d %>% replace_na(list(authors.x_142 = ""))
d <- d %>% replace_na(list(authors.x_143 = ""))
d <- d %>% replace_na(list(authors.x_144 = ""))
d <- d %>% replace_na(list(authors.x_145 = ""))
d <- d %>% replace_na(list(authors.x_146 = ""))
d <- d %>% replace_na(list(authors.x_147 = ""))
d <- d %>% replace_na(list(authors.x_148 = ""))
d <- d %>% replace_na(list(authors.x_149 = ""))
d <- d %>% replace_na(list(authors.x_150 = ""))
d <- d %>% replace_na(list(authors.x_151 = ""))
d <- d %>% replace_na(list(authors.x_152 = ""))
d <- d %>% replace_na(list(authors.x_153 = ""))
d <- d %>% replace_na(list(authors.x_154 = ""))
d <- d %>% replace_na(list(authors.x_155 = ""))
d <- d %>% replace_na(list(authors.x_156 = ""))
d <- d %>% replace_na(list(authors.x_157 = ""))
d <- d %>% replace_na(list(authors.x_158 = ""))
d <- d %>% replace_na(list(authors.x_159 = ""))
d <- d %>% replace_na(list(authors.x_160 = ""))
d <- d %>% replace_na(list(authors.x_161 = ""))
d <- d %>% replace_na(list(authors.x_162 = ""))
d <- d %>% replace_na(list(authors.x_163 = ""))
d <- d %>% replace_na(list(authors.x_164 = ""))
d <- d %>% replace_na(list(authors.x_165 = ""))
d <- d %>% replace_na(list(authors.x_166 = ""))
d <- d %>% replace_na(list(authors.x_167 = ""))
d <- d %>% replace_na(list(authors.x_168 = ""))
d <- d %>% replace_na(list(authors.x_169 = ""))
d <- d %>% replace_na(list(authors.x_170 = ""))
d <- d %>% replace_na(list(authors.x_171 = ""))
d <- d %>% replace_na(list(authors.x_172 = ""))
d <- d %>% replace_na(list(authors.x_173 = ""))
d <- d %>% replace_na(list(authors.x_174 = ""))
d <- d %>% replace_na(list(authors.x_175 = ""))
d <- d %>% replace_na(list(authors.x_176 = ""))
d <- d %>% replace_na(list(authors.x_177 = ""))
d <- d %>% replace_na(list(authors.x_178 = ""))
d <- d %>% replace_na(list(authors.x_179 = ""))
d <- d %>% replace_na(list(authors.x_180 = ""))
d <- d %>% replace_na(list(authors.x_181 = ""))
d <- d %>% replace_na(list(authors.x_182 = ""))
d <- d %>% replace_na(list(authors.x_183 = ""))
d <- d %>% replace_na(list(authors.x_184 = ""))
d <- d %>% replace_na(list(authors.x_185 = ""))
d <- d %>% replace_na(list(authors.x_186 = ""))
d <- d %>% replace_na(list(authors.x_187 = ""))
d <- d %>% replace_na(list(authors.x_188 = ""))
d <- d %>% replace_na(list(authors.x_189 = ""))
d <- d %>% replace_na(list(authors.x_190 = ""))
d <- d %>% replace_na(list(authors.x_191 = ""))
d <- d %>% replace_na(list(authors.x_192 = ""))
d <- d %>% replace_na(list(authors.x_193 = ""))
d <- d %>% replace_na(list(authors.x_194 = ""))
d <- d %>% replace_na(list(authors.x_195 = ""))
d <- d %>% replace_na(list(authors.x_196 = ""))
d <- d %>% replace_na(list(authors.x_197 = ""))
d <- d %>% replace_na(list(authors.x_198 = ""))
d <- d %>% replace_na(list(authors.x_199 = ""))
d <- d %>% replace_na(list(authors.x_200 = ""))
d <- d %>% replace_na(list(authors.x_201 = ""))
d <- d %>% replace_na(list(authors.x_202 = ""))
d <- d %>% replace_na(list(authors.x_203 = ""))
d <- d %>% replace_na(list(authors.x_204 = ""))
d <- d %>% replace_na(list(authors.x_205 = ""))
d <- d %>% replace_na(list(authors.x_206 = ""))
d <- d %>% replace_na(list(authors.x_207 = ""))
d <- d %>% replace_na(list(authors.x_208 = ""))
d <- d %>% replace_na(list(authors.x_209 = ""))
d <- d %>% replace_na(list(authors.x_210 = ""))
d <- d %>% replace_na(list(authors.x_211 = ""))
d <- d %>% replace_na(list(authors.x_212 = ""))
d <- d %>% replace_na(list(authors.x_213 = ""))
d <- d %>% replace_na(list(authors.x_214 = ""))
d <- d %>% replace_na(list(authors.x_215 = ""))
d <- d %>% replace_na(list(authors.x_216 = ""))
d <- d %>% replace_na(list(authors.x_217 = ""))
d <- d %>% replace_na(list(authors.x_218 = ""))
d <- d %>% replace_na(list(authors.x_219 = ""))
d <- d %>% replace_na(list(authors.x_220 = ""))
d <- d %>% replace_na(list(authors.x_221 = ""))
d <- d %>% replace_na(list(authors.x_222 = ""))
d <- d %>% replace_na(list(authors.x_223 = ""))
d <- d %>% replace_na(list(authors.x_224 = ""))
d <- d %>% replace_na(list(authors.x_225 = ""))
d <- d %>% replace_na(list(authors.x_226 = ""))
d <- d %>% replace_na(list(authors.x_227 = ""))
d <- d %>% replace_na(list(authors.x_228 = ""))
d <- d %>% replace_na(list(authors.x_229 = ""))
d <- d %>% replace_na(list(authors.x_230 = ""))
d <- d %>% replace_na(list(authors.x_231 = ""))
d <- d %>% replace_na(list(authors.x_232 = ""))
d <- d %>% replace_na(list(authors.x_233 = ""))
d <- d %>% replace_na(list(authors.x_234 = ""))
d <- d %>% replace_na(list(authors.x_235 = ""))
d <- d %>% replace_na(list(authors.x_236 = ""))
d <- d %>% replace_na(list(authors.x_237 = ""))
# d <- d %>% replace_na(list(authors.x_238 = ""))
# d <- d %>% replace_na(list(authors.x_239 = ""))
# d <- d %>% replace_na(list(authors.x_240 = ""))
# d <- d %>% replace_na(list(authors.x_241 = ""))
# d <- d %>% replace_na(list(authors.x_242 = ""))
# d <- d %>% replace_na(list(authors.x_243 = ""))
# d <- d %>% replace_na(list(authors.x_244 = ""))
# d <- d %>% replace_na(list(authors.x_245 = ""))
# d <- d %>% replace_na(list(authors.x_246 = ""))
# d <- d %>% replace_na(list(authors.x_247 = ""))
# d <- d %>% replace_na(list(authors.x_248 = ""))
# d <- d %>% replace_na(list(authors.x_249 = ""))
# d <- d %>% replace_na(list(authors.x_250 = ""))
# d <- d %>% replace_na(list(authors.x_251 = ""))
# d <- d %>% replace_na(list(authors.x_252 = ""))
# d <- d %>% replace_na(list(authors.x_253 = ""))
# d <- d %>% replace_na(list(authors.x_254 = ""))
# d <- d %>% replace_na(list(authors.x_255 = ""))
# d <- d %>% replace_na(list(authors.x_256 = ""))
# d <- d %>% replace_na(list(authors.x_257 = ""))
# d <- d %>% replace_na(list(authors.x_258 = ""))
# d <- d %>% replace_na(list(authors.x_259 = ""))
# d <- d %>% replace_na(list(authors.x_260 = ""))
# d <- d %>% replace_na(list(authors.x_261 = ""))
# d <- d %>% replace_na(list(authors.x_262 = ""))
# d <- d %>% replace_na(list(authors.x_263 = ""))
# d <- d %>% replace_na(list(authors.x_264 = ""))
# d <- d %>% replace_na(list(authors.x_265 = ""))
# d <- d %>% replace_na(list(authors.x_266 = ""))
# d <- d %>% replace_na(list(authors.x_267 = ""))
# d <- d %>% replace_na(list(authors.x_268 = ""))
# d <- d %>% replace_na(list(authors.x_269 = ""))
# d <- d %>% replace_na(list(authors.x_270 = ""))
# d <- d %>% replace_na(list(authors.x_271 = ""))
# d <- d %>% replace_na(list(authors.x_272 = ""))
# d <- d %>% replace_na(list(authors.x_273 = ""))
# d <- d %>% replace_na(list(authors.x_274 = ""))
# d <- d %>% replace_na(list(authors.x_275 = ""))
# d <- d %>% replace_na(list(authors.x_276 = ""))
# d <- d %>% replace_na(list(authors.x_277 = ""))
# d <- d %>% replace_na(list(authors.x_278 = ""))
# d <- d %>% replace_na(list(authors.x_279 = ""))
# d <- d %>% replace_na(list(authors.x_280 = ""))
# d <- d %>% replace_na(list(authors.x_281 = ""))
# d <- d %>% replace_na(list(authors.x_282 = ""))
# d <- d %>% replace_na(list(authors.x_283 = ""))
# d <- d %>% replace_na(list(authors.x_284 = ""))
# d <- d %>% replace_na(list(authors.x_285 = ""))
# d <- d %>% replace_na(list(authors.x_286 = ""))
# d <- d %>% replace_na(list(authors.x_287 = ""))
# d <- d %>% replace_na(list(authors.x_288 = ""))
# d <- d %>% replace_na(list(authors.x_289 = ""))
# d <- d %>% replace_na(list(authors.x_290 = ""))
# d <- d %>% replace_na(list(authors.x_291 = ""))
# d <- d %>% replace_na(list(authors.x_292 = ""))
# d <- d %>% replace_na(list(authors.x_293 = ""))
# d <- d %>% replace_na(list(authors.x_294 = ""))
# d <- d %>% replace_na(list(authors.x_295 = ""))
# d <- d %>% replace_na(list(authors.x_296 = ""))
# d <- d %>% replace_na(list(authors.x_297 = ""))
# d <- d %>% replace_na(list(authors.x_298 = ""))
# d <- d %>% replace_na(list(authors.x_299 = ""))
# d <- d %>% replace_na(list(authors.x_300 = ""))
# d <- d %>% replace_na(list(authors.x_301 = ""))
# d <- d %>% replace_na(list(authors.x_302 = ""))
# d <- d %>% replace_na(list(authors.x_303 = ""))
# d <- d %>% replace_na(list(authors.x_304 = ""))
# d <- d %>% replace_na(list(authors.x_305 = ""))
# d <- d %>% replace_na(list(authors.x_306 = ""))
# d <- d %>% replace_na(list(authors.x_307 = ""))
# d <- d %>% replace_na(list(authors.x_308 = ""))
# d <- d %>% replace_na(list(authors.x_309 = ""))
# d <- d %>% replace_na(list(authors.x_310 = ""))
# d <- d %>% replace_na(list(authors.x_311 = ""))
# d <- d %>% replace_na(list(authors.x_312 = ""))
# d <- d %>% replace_na(list(authors.x_313 = ""))
# d <- d %>% replace_na(list(authors.x_314 = ""))
# d <- d %>% replace_na(list(authors.x_315 = ""))
# d <- d %>% replace_na(list(authors.x_316 = ""))
# d <- d %>% replace_na(list(authors.x_317 = ""))
# d <- d %>% replace_na(list(authors.x_318 = ""))
# d <- d %>% replace_na(list(authors.x_319 = ""))
# d <- d %>% replace_na(list(authors.x_320 = ""))
# d <- d %>% replace_na(list(authors.x_321 = ""))
# d <- d %>% replace_na(list(authors.x_322 = ""))
# d <- d %>% replace_na(list(authors.x_323 = ""))
# d <- d %>% replace_na(list(authors.x_324 = ""))
# d <- d %>% replace_na(list(authors.x_325 = ""))
# d <- d %>% replace_na(list(authors.x_326 = ""))
# d <- d %>% replace_na(list(authors.x_327 = ""))
# d <- d %>% replace_na(list(authors.x_328 = ""))
# d <- d %>% replace_na(list(authors.x_329 = ""))
# d <- d %>% replace_na(list(authors.x_330 = ""))
# d <- d %>% replace_na(list(authors.x_331 = ""))
# d <- d %>% replace_na(list(authors.x_332 = ""))
# d <- d %>% replace_na(list(authors.x_333 = ""))
# d <- d %>% replace_na(list(authors.x_334 = ""))
# d <- d %>% replace_na(list(authors.x_335 = ""))
# d <- d %>% replace_na(list(authors.x_336 = ""))
# d <- d %>% replace_na(list(authors.x_337 = ""))
# d <- d %>% replace_na(list(authors.x_338 = ""))
# d <- d %>% replace_na(list(authors.x_339 = ""))
# d <- d %>% replace_na(list(authors.x_340 = ""))
# d <- d %>% replace_na(list(authors.x_341 = ""))
# d <- d %>% replace_na(list(authors.x_342 = ""))
# d <- d %>% replace_na(list(authors.x_343 = ""))
# d <- d %>% replace_na(list(authors.x_344 = ""))
# d <- d %>% replace_na(list(authors.x_345 = ""))
# d <- d %>% replace_na(list(authors.x_346 = ""))
# d <- d %>% replace_na(list(authors.x_347 = ""))
# d <- d %>% replace_na(list(authors.x_348 = ""))
# d <- d %>% replace_na(list(authors.x_349 = ""))
# d <- d %>% replace_na(list(authors.x_350 = ""))
# d <- d %>% replace_na(list(authors.x_351 = ""))
# d <- d %>% replace_na(list(authors.x_352 = ""))
# d <- d %>% replace_na(list(authors.x_353 = ""))
# d <- d %>% replace_na(list(authors.x_354 = ""))
# d <- d %>% replace_na(list(authors.x_355 = ""))
# d <- d %>% replace_na(list(authors.x_356 = ""))
# d <- d %>% replace_na(list(authors.x_357 = ""))
# d <- d %>% replace_na(list(authors.x_358 = ""))
# d <- d %>% replace_na(list(authors.x_359 = ""))
# d <- d %>% replace_na(list(authors.x_360 = ""))
# d <- d %>% replace_na(list(authors.x_361 = ""))
# d <- d %>% replace_na(list(authors.x_362 = ""))
# d <- d %>% replace_na(list(authors.x_363 = ""))
# d <- d %>% replace_na(list(authors.x_364 = ""))
# d <- d %>% replace_na(list(authors.x_365 = ""))
# d <- d %>% replace_na(list(authors.x_366 = ""))
# d <- d %>% replace_na(list(authors.x_367 = ""))
# d <- d %>% replace_na(list(authors.x_368 = ""))
# d <- d %>% replace_na(list(authors.x_369 = ""))
# d <- d %>% replace_na(list(authors.x_370 = ""))
# d <- d %>% replace_na(list(authors.x_371 = ""))
# d <- d %>% replace_na(list(authors.x_372 = ""))
# d <- d %>% replace_na(list(authors.x_373 = ""))
# d <- d %>% replace_na(list(authors.x_374 = ""))
# d <- d %>% replace_na(list(authors.x_375 = ""))
# d <- d %>% replace_na(list(authors.x_376 = ""))
# d <- d %>% replace_na(list(authors.x_377 = ""))
# d <- d %>% replace_na(list(authors.x_378 = ""))
# d <- d %>% replace_na(list(authors.x_379 = ""))
# d <- d %>% replace_na(list(authors.x_380 = ""))
# d <- d %>% replace_na(list(authors.x_381 = ""))
# d <- d %>% replace_na(list(authors.x_382 = ""))
# d <- d %>% replace_na(list(authors.x_383 = ""))
# d <- d %>% replace_na(list(authors.x_384 = ""))
# d <- d %>% replace_na(list(authors.x_385 = ""))
# d <- d %>% replace_na(list(authors.x_386 = ""))
# d <- d %>% replace_na(list(authors.x_387 = ""))
# d <- d %>% replace_na(list(authors.x_388 = ""))
# d <- d %>% replace_na(list(authors.x_389 = ""))
# d <- d %>% replace_na(list(authors.x_390 = ""))
# d <- d %>% replace_na(list(authors.x_391 = ""))
# d <- d %>% replace_na(list(authors.x_392 = ""))
# d <- d %>% replace_na(list(authors.x_393 = ""))
# d <- d %>% replace_na(list(authors.x_394 = ""))
# d <- d %>% replace_na(list(authors.x_395 = ""))
# d <- d %>% replace_na(list(authors.x_396 = ""))
# d <- d %>% replace_na(list(authors.x_397 = ""))
# d <- d %>% replace_na(list(authors.x_398 = ""))
# d <- d %>% replace_na(list(authors.x_399 = ""))
# d <- d %>% replace_na(list(authors.x_400 = ""))
# d <- d %>% replace_na(list(authors.x_401 = ""))
# d <- d %>% replace_na(list(authors.x_402 = ""))
# d <- d %>% replace_na(list(authors.x_403 = ""))
# d <- d %>% replace_na(list(authors.x_404 = ""))
# d <- d %>% replace_na(list(authors.x_405 = ""))
# d <- d %>% replace_na(list(authors.x_406 = ""))
# d <- d %>% replace_na(list(authors.x_407 = ""))
# d <- d %>% replace_na(list(authors.x_408 = ""))
# d <- d %>% replace_na(list(authors.x_409 = ""))
# d <- d %>% replace_na(list(authors.x_410 = ""))
# d <- d %>% replace_na(list(authors.x_411 = ""))
# d <- d %>% replace_na(list(authors.x_412 = ""))
# d <- d %>% replace_na(list(authors.x_413 = ""))
# d <- d %>% replace_na(list(authors.x_414 = ""))
# d <- d %>% replace_na(list(authors.x_415 = ""))
# d <- d %>% replace_na(list(authors.x_416 = ""))
# d <- d %>% replace_na(list(authors.x_417 = ""))

# Remove the comma and period symbols in authors.y, authors.x and authors.y_dup
d <- d %>% mutate(across("authors.y", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.y", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.y_dup", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.y_dup", str_replace_all, "\\." , ""))

d <- d %>% mutate(across("authors.x_001", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_002", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_003", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_004", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_005", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_006", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_007", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_008", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_009", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_010", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_011", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_012", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_013", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_014", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_015", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_016", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_017", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_018", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_019", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_020", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_021", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_022", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_023", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_024", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_025", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_026", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_027", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_028", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_029", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_030", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_031", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_032", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_033", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_034", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_035", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_036", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_037", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_038", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_039", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_040", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_041", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_042", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_043", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_044", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_045", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_046", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_047", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_048", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_049", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_050", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_051", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_052", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_053", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_054", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_055", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_056", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_057", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_058", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_059", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_060", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_061", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_062", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_063", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_064", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_065", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_066", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_067", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_068", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_069", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_070", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_071", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_072", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_073", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_074", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_075", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_076", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_077", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_078", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_079", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_080", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_081", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_082", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_083", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_084", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_085", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_086", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_087", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_088", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_089", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_090", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_091", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_092", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_093", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_094", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_095", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_096", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_097", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_098", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_099", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_100", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_101", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_102", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_103", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_104", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_105", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_106", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_107", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_108", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_109", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_110", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_111", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_112", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_113", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_114", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_115", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_116", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_117", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_118", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_119", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_120", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_121", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_122", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_123", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_124", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_125", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_126", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_127", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_128", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_129", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_130", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_131", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_132", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_133", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_134", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_135", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_136", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_137", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_138", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_139", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_140", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_141", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_142", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_143", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_144", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_145", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_146", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_147", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_148", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_149", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_150", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_151", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_152", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_153", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_154", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_155", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_156", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_157", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_158", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_159", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_160", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_161", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_162", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_163", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_164", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_165", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_166", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_167", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_168", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_169", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_170", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_171", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_172", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_173", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_174", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_175", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_176", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_177", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_178", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_179", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_180", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_181", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_182", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_183", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_184", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_185", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_186", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_187", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_188", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_189", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_190", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_191", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_192", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_193", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_194", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_195", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_196", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_197", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_198", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_199", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_200", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_201", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_202", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_203", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_204", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_205", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_206", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_207", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_208", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_209", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_210", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_211", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_212", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_213", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_214", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_215", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_216", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_217", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_218", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_219", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_220", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_221", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_222", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_223", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_224", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_225", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_226", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_227", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_228", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_229", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_230", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_231", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_232", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_233", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_234", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_235", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_236", str_replace_all, "," , ""))
d <- d %>% mutate(across("authors.x_237", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_238", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_239", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_240", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_241", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_242", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_243", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_244", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_245", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_246", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_247", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_248", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_249", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_250", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_251", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_252", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_253", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_254", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_255", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_256", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_257", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_258", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_259", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_260", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_261", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_262", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_263", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_264", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_265", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_266", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_267", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_268", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_269", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_270", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_271", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_272", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_273", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_274", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_275", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_276", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_277", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_278", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_279", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_280", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_281", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_282", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_283", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_284", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_285", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_286", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_287", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_288", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_289", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_290", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_291", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_292", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_293", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_294", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_295", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_296", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_297", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_298", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_299", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_300", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_301", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_302", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_303", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_304", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_305", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_306", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_307", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_308", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_309", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_310", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_311", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_312", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_313", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_314", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_315", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_316", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_317", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_318", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_319", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_320", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_321", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_322", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_323", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_324", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_325", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_326", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_327", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_328", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_329", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_330", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_331", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_332", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_333", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_334", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_335", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_336", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_337", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_338", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_339", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_340", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_341", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_342", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_343", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_344", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_345", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_346", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_347", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_348", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_349", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_350", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_351", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_352", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_353", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_354", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_355", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_356", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_357", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_358", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_359", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_360", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_361", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_362", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_363", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_364", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_365", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_366", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_367", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_368", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_369", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_370", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_371", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_372", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_373", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_374", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_375", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_376", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_377", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_378", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_379", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_380", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_381", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_382", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_383", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_384", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_385", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_386", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_387", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_388", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_389", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_390", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_391", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_392", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_393", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_394", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_395", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_396", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_397", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_398", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_399", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_400", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_401", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_402", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_403", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_404", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_405", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_406", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_407", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_408", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_409", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_410", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_411", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_412", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_413", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_414", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_415", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_416", str_replace_all, "," , ""))
# d <- d %>% mutate(across("authors.x_417", str_replace_all, "," , ""))

d <- d %>% mutate(across("authors.x_001", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_002", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_003", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_004", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_005", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_006", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_007", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_008", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_009", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_010", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_011", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_012", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_013", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_014", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_015", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_016", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_017", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_018", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_019", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_020", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_021", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_022", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_023", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_024", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_025", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_026", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_027", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_028", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_029", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_030", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_031", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_032", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_033", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_034", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_035", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_036", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_037", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_038", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_039", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_040", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_041", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_042", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_043", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_044", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_045", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_046", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_047", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_048", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_049", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_050", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_051", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_052", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_053", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_054", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_055", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_056", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_057", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_058", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_059", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_060", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_061", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_062", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_063", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_064", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_065", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_066", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_067", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_068", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_069", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_070", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_071", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_072", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_073", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_074", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_075", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_076", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_077", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_078", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_079", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_080", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_081", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_082", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_083", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_084", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_085", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_086", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_087", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_088", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_089", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_090", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_091", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_092", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_093", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_094", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_095", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_096", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_097", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_098", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_099", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_100", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_101", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_102", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_103", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_104", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_105", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_106", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_107", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_108", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_109", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_110", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_111", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_112", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_113", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_114", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_115", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_116", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_117", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_118", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_119", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_120", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_121", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_122", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_123", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_124", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_125", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_126", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_127", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_128", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_129", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_130", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_131", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_132", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_133", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_134", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_135", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_136", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_137", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_138", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_139", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_140", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_141", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_142", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_143", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_144", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_145", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_146", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_147", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_148", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_149", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_150", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_151", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_152", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_153", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_154", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_155", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_156", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_157", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_158", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_159", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_160", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_161", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_162", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_163", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_164", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_165", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_166", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_167", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_168", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_169", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_170", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_171", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_172", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_173", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_174", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_175", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_176", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_177", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_178", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_179", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_180", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_181", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_182", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_183", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_184", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_185", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_186", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_187", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_188", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_189", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_190", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_191", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_192", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_193", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_194", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_195", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_196", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_197", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_198", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_199", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_200", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_201", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_202", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_203", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_204", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_205", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_206", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_207", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_208", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_209", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_210", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_211", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_212", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_213", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_214", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_215", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_216", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_217", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_218", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_219", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_220", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_221", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_222", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_223", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_224", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_225", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_226", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_227", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_228", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_229", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_230", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_231", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_232", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_233", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_234", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_235", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_236", str_replace_all, "\\." , ""))
d <- d %>% mutate(across("authors.x_237", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_238", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_239", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_240", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_241", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_242", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_243", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_244", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_245", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_246", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_247", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_248", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_249", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_250", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_251", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_252", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_253", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_254", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_255", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_256", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_257", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_258", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_259", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_260", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_261", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_262", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_263", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_264", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_265", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_266", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_267", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_268", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_269", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_270", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_271", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_272", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_273", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_274", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_275", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_276", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_277", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_278", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_279", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_280", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_281", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_282", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_283", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_284", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_285", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_286", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_287", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_288", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_289", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_290", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_291", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_292", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_293", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_294", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_295", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_296", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_297", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_298", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_299", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_300", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_301", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_302", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_303", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_304", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_305", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_306", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_307", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_308", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_309", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_310", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_311", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_312", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_313", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_314", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_315", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_316", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_317", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_318", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_319", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_320", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_321", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_322", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_323", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_324", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_325", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_326", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_327", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_328", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_329", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_330", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_331", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_332", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_333", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_334", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_335", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_336", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_337", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_338", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_339", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_340", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_341", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_342", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_343", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_344", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_345", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_346", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_347", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_348", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_349", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_350", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_351", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_352", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_353", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_354", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_355", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_356", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_357", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_358", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_359", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_360", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_361", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_362", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_363", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_364", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_365", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_366", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_367", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_368", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_369", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_370", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_371", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_372", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_373", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_374", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_375", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_376", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_377", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_378", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_379", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_380", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_381", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_382", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_383", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_384", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_385", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_386", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_387", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_388", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_389", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_390", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_391", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_392", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_393", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_394", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_395", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_396", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_397", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_398", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_399", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_400", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_401", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_402", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_403", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_404", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_405", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_406", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_407", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_408", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_409", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_410", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_411", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_412", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_413", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_414", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_415", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_416", str_replace_all, "\\." , ""))
# d <- d %>% mutate(across("authors.x_417", str_replace_all, "\\." , ""))

# For loop which checks the comparison, and places the author names in either the
# overlapping or non-overlapping columns
for (i in 1:nrow(d)) {
  
  for (j in 1:237) {
    author_num <- sprintf("%03d", j)
    if(nchar(d[[i,paste0("authors.x_", author_num)]])!= 0) {
      ifelse(grepl(d[[i,paste0("authors.x_", author_num)]], d[[i,"authors.y"]]),d[[i,"overlapping_names"]] <- paste(d[[i,"overlapping_names"]],d[[i,paste0("authors.x_", author_num)]]),d[[i,"non_overlapping_names"]] <- paste(d[[i,"non_overlapping_names"]],d[[i,paste0("authors.x_", author_num)]]))
      if(grepl(d[[i,paste0("authors.x_", author_num)]], d[[i,"authors.y"]])) {
        d[[i,"authors.y_dup"]] <- str_replace(d[[i,"authors.y_dup"]], d[[i,paste0("authors.x_", author_num)]], "")
      }
    }
  }
  
  d[[i,"non_overlapping_names"]] <- paste(d[[i,"non_overlapping_names"]],d[[i,"authors.y_dup"]])
  d[[i,"non_overlapping_names"]] <- str_replace_all(d[[i,"non_overlapping_names"]],"\t"," ")
  d[[i,"non_overlapping_names"]] <- str_replace_all(d[[i,"non_overlapping_names"]],"  "," ")
  d[[i,"non_overlapping_names"]] <- str_replace_all(d[[i,"non_overlapping_names"]],"  "," ")
  
  d[[i,"non_overlapping_names"]] <- str_trim(d[[i,"non_overlapping_names"]]) 
  d[[i,"overlapping_names"]] <- str_trim(d[[i,"overlapping_names"]])
  
  d[[i,"count_non_overlapping_names"]] <- sapply(strsplit(d[[i,"non_overlapping_names"]], " "), length)
  d[[i,"count_overlapping_names"]] <- sapply(strsplit(d[[i,"overlapping_names"]], " "), length)
  
}

setwd("/groups/sebratt/mrudanglangalia/Frontiers_Files")
write.csv(d, "Reference_with_year_authoroverlap_2020-21.csv", row.names = TRUE)

############################################################
